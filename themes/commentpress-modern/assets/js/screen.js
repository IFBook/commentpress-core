function commentpress_setup_comment_headers(){jQuery.reset_comment_actions();jQuery.setup_comment_headers()}var cp_header_height,cp_header_animating,cp_toc_on_top,page_highlight,cp_header_minimised,cp_sidebar_minimised,cp_container_top_max,cp_container_top_min;cp_header_height=70;cp_header_animating=false;page_highlight=false;if(cp_bp_adminbar=="y"){cp_wp_adminbar_height=25;cp_wp_adminbar="y"}if(cp_wp_adminbar=="y"){}function cp_page_setup(){var b,c,d,a;b="";if(document.getElementById){b+='<style type="text/css" media="screen">';if(cp_is_mobile=="0"){if(cp_textblock_meta=="0"){b+="#content .textblock span.para_marker, #content .textblock span.commenticonbox { display: none; } ";b+=".content .textblock span.para_marker, .content .textblock span.commenticonbox { display: none; } "}}b+="ul.all_comments_listing div.item_body { display: none; } ";if(cp_wp_adminbar=="y"){b+="body.admin-bar #header, #header { top: "+cp_wp_adminbar_height+"px; } ";b+="body.admin-bar #sidebar, #sidebar, body.admin-bar #navigation, #navigation { top: "+(cp_wp_adminbar_height+cp_header_height)+"px; } ";if(cp_wp_adminbar_height=="32"){b+="@media screen and ( max-width: 782px ) { body.admin-bar #header, #header { top: "+cp_wp_adminbar_expanded+"px; }body.admin-bar #sidebar, #sidebar, body.admin-bar #navigation, #navigation { top: "+(cp_wp_adminbar_expanded+cp_header_height)+"px; } } "}}if(cp_show_subpages=="0"){b+="#toc_sidebar .sidebar_contents_wrapper ul li ul { display: none; } ";b+="#toc_sidebar .sidebar_contents_wrapper ul li.current_page_ancestor > ul { display: block; } "}if(cp_special_page=="0"){b+="#respond { display: none; } "}b+="#sidebar .paragraph_wrapper { display: none; } ";b+="#navigation .paragraph_wrapper { display: none; } ";b+="#sidebar .paragraph_wrapper.start_open { display: block; } ";b+="#navigation .paragraph_wrapper.start_open { display: block; } ";b+=".commentpress_page #navigation .paragraph_wrapper.special_pages_wrapper { display: block; } ";b+="#original .post, #literal .post { display: none; } ";b+="</style>"}document.write(b)}cp_page_setup();function commentpress_get_header_offset(){var a;a=0-jQuery("#header").height()-jQuery("#sidebar_tabs").height();if(cp_wp_adminbar=="y"){a-=cp_wp_adminbar_height}return a}function commentpress_scroll_to_top(c,b){if(typeof c==="undefined"){return}var a;if(cp_is_mobile=="0"||cp_is_tablet=="1"){if(c==0){a=jQuery(".comments_container").prop("id");if(typeof a!=="undefined"){target_id=a.split("-")[1];c=jQuery("#post-"+target_id)}}jQuery.scrollTo(c,{duration:(b*1.5),axis:"y",offset:commentpress_get_header_offset()})}}function cp_scroll_to_anchor_on_load(){var j,d,e,i,k,a,h,f,c,b,g;j="";d=document.location.toString();if(d.match("#comment-")){cp_activate_sidebar("comments");e=d.split("#comment-")[1];i=jQuery("#comment-"+e).parents("div.paragraph_wrapper").map(function(){return this});if(i.length>0){k=jQuery(i[0]);if(cp_comments_open=="y"){j=k.prop("id").split("-")[1];a=jQuery("#para_wrapper-"+j+" .reply_to_para").prop("id");h=a.split("-")[1];f=jQuery("#comment_post_ID").prop("value");if(cp_tinymce=="1"){if(jQuery("#comment-"+e+" > .reply").text()!==""){cp_tinymce="0";addComment.moveForm("comment-"+e,e,"respond",f,j);cp_tinymce="1"}}else{addComment.moveForm("comment-"+e,e,"respond",f,j)}}k.show();cp_scroll_comments(jQuery("#comment-"+e),1,"flash");if(j!==""){c=jQuery("#textblock-"+j);jQuery.highlight_para(c);commentpress_scroll_page(c)}else{if(page_highlight===false){commentpress_scroll_to_top(0,cp_scroll_speed)}page_highlight=!page_highlight}return}}else{jQuery("span.para_marker > a").each(function(o){var p,m,l,n,q;p=jQuery(this).prop("id");if(d.match("#"+p)||d.match("#para_heading-"+p)){if(cp_comments_open=="y"){m=jQuery("#para_wrapper-"+p+" .reply_to_para").prop("id");l=m.split("-")[1];n=jQuery("#comment_post_ID").prop("value");addComment.moveFormToPara(l,p,n)}jQuery("#para_heading-"+p).next("div.paragraph_wrapper").show();cp_scroll_comments(jQuery("#para_heading-"+p),1);q=jQuery("#textblock-"+p);jQuery.highlight_para(q);commentpress_scroll_page(q);return}})}if(d.match("#respond")){jQuery("h3#para_heading- a.comment_block_permalink").click();return}if(d.match("#")){b=d.split("#")[1];if(b=="edit=true"){return}if(b=="fee-edit-link"){return}g=jQuery("#"+b);if(g.length){commentpress_scroll_page(g)}return}}function cp_do_comment_icon_action(l,i){if(!jQuery("body").hasClass("active-sidebar")||jQuery("body").hasClass("active-nav")){CommentPress.modern.columns.show_discuss()}var j,b,d,h,e,g,c,f,a,k;j=jQuery("#para_heading-"+l).next("div.paragraph_wrapper");if(j.length==0){return}b=jQuery("#para_wrapper-"+l+" .commentlist");d=j.find("#respond");h=addComment.getLevel();cp_activate_sidebar("comments");e=false;g=j.css("display");if(g=="none"){e=true}jQuery.unhighlight_para();if(l!==""){c=jQuery("#textblock-"+l);if(cp_promote_reading=="1"&&!e){}else{jQuery.highlight_para(c);commentpress_scroll_page(c)}}if(cp_promote_reading=="0"){if(cp_comments_open=="y"){f=jQuery("#comment_post_ID").prop("value");a=jQuery("#para_wrapper-"+l+" .reply_to_para").prop("id");k=a.split("-")[1]}if(!d[0]){if(cp_comments_open=="y"){addComment.moveFormToPara(k,l,f)}}if(d[0]&&!h){if(cp_comments_open=="y"){addComment.moveFormToPara(k,l,f);if(i=="marker"){cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}else{cp_scroll_comments(jQuery("#respond"),cp_scroll_speed)}}else{cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}return}if(!d[0]&&b[0]&&!e){if(cp_comments_open=="y"){if(i=="marker"){cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}else{cp_scroll_comments(jQuery("#respond"),cp_scroll_speed)}}else{cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}return}if(!e&&b[0]){if(cp_comments_open=="y"){if(i=="marker"){cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}else{cp_scroll_comments(jQuery("#respond"),cp_scroll_speed)}}else{cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}return}if(d[0]&&!b[0]&&!e){if(cp_comments_open=="y"){if(i=="marker"){cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}else{cp_scroll_comments(jQuery("#respond"),cp_scroll_speed)}}else{cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}return}if(!e&&!b[0]){j.css("display","none");e=true}}j.slideToggle("slow",function(){if(cp_promote_reading=="1"&&e){cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}else{if(e){if(cp_comments_open=="y"){if(i=="marker"){cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}else{cp_scroll_comments(jQuery("#respond"),cp_scroll_speed)}}else{cp_scroll_comments(jQuery("#para_heading-"+l),cp_scroll_speed)}}}})}function cp_activate_sidebar(d){if(d=="comments"){if(!jQuery("body").hasClass("active-sidebar")||jQuery("body").hasClass("active-nav")){CommentPress.modern.columns.show_discuss()}}var b,c,a;b=jQuery("#"+d+"_sidebar").css("z-index");if(b=="2001"){jQuery(".sidebar_container").css("z-index","2001");jQuery("#sidebar_tabs h2 a").removeClass("active-tab");jQuery("#"+d+"_sidebar").css("z-index","2010");jQuery("#sidebar_tabs #"+d+"_header h2 a").addClass("active-tab")}}jQuery("html").addClass("js");CommentPress.modern={};CommentPress.modern.columns=new function(){var a=this;this.show_nav=function(){jQuery("body").toggleClass("active-nav").removeClass("active-sidebar");jQuery(".sidebar-button,.content-button").removeClass("active-button");jQuery(".navigation-button").toggleClass("active-button")},this.show_content=function(){jQuery("body").removeClass("active-sidebar").removeClass("active-nav");jQuery(".navigation-button,.sidebar-button").removeClass("active-button");jQuery(".content-button").toggleClass("active-button")},this.show_discuss=function(){jQuery("body").toggleClass("active-sidebar").removeClass("active-nav");jQuery(".navigation-button,.content-button").removeClass("active-button");jQuery(".sidebar-button").toggleClass("active-button")},this.enable_buttons=function(){jQuery(".navigation-button").click(function(b){b.preventDefault();a.show_nav()});jQuery(".content-button").click(function(b){b.preventDefault();a.show_content()});jQuery(".sidebar-button").click(function(b){b.preventDefault();a.show_discuss()})}};CommentPress.modern.viewport=new function(){var a=this;this.track=function(){jQuery(window).resize(function(){a.set_height()})},this.set_height=function(){var g,i,f,b,c,e,d,j,h;g=jQuery(window).height();i=jQuery("#header").height();f=jQuery("#switcher").height();b=jQuery("#toc_sidebar > .sidebar_header").height();if(cp_wp_adminbar=="y"){c=jQuery("#wpadminbar").height()}else{c=0}e=g-(i+b+c);d=jQuery("#switcher").css("display");if(d==="block"){e=e-f}jQuery("#toc_sidebar .sidebar_contents_wrapper").css("height",e+"px");j=jQuery("#sidebar_tabs").height();h=g-(i+j+c);if(d==="block"){h=h-f}jQuery("#sidebar .sidebar_contents_wrapper").css("height",h+"px")}};CommentPress.modern.viewport.track();jQuery(document).ready(function(b){CommentPress.modern.viewport.set_height();commentpress_reset_actions();CommentPress.modern.columns.enable_buttons();b(window).scroll(function(){var l,n,k,e,f,j,h,o,m,i,g,p,d;i=b("#header");position=i.css("position");if(position=="absolute"){n=i.height();g=i.position();p=window.pageYOffset-(g.top+n);if(parseInt(p)>0){d=b.px_to_num(b("html body #content_container #sidebar").css("top"));if(d=="0"){return}b("html body #content_container #sidebar,html body #content_container #navigation").css("top","0");l=b(window).height();k=b("#switcher").height();e=b("#toc_sidebar > .sidebar_header").height();j=l-e;h=b("#switcher").css("display");if(h==="block"){j=j-k}b("#toc_sidebar .sidebar_contents_wrapper").css("height",j+"px");o=b("#sidebar_tabs").height();m=l-o;if(h==="block"){m=m-k}b("#sidebar .sidebar_contents_wrapper").css("height",m+"px")}else{if(cp_wp_adminbar=="y"){f=b("#wpadminbar").height()}else{f=0}d=b.px_to_num(b("html body #content_container #sidebar").css("top"));if(d==n+f){return}b("html body #content_container #sidebar,html body #content_container #navigation").css("top",(n+f)+"px");CommentPress.modern.viewport.set_height()}}});b("#activity_header h2 a").click(function(d){d.preventDefault();cp_activate_sidebar("activity")});b("#comments_header h2 a").click(function(d){d.preventDefault();cp_activate_sidebar("comments")});b("a.para_permalink").click(function(d){d.preventDefault()});b("a.comment_block_permalink").click(function(d){d.preventDefault()});b("#cp_minimise_all_comments").click(function(d){d.preventDefault();b("#comments_sidebar div.paragraph_wrapper").slideUp();b.unhighlight_para()});b("#cp_minimise_all_activity").click(function(d){d.preventDefault();b("#activity_sidebar div.paragraph_wrapper").slideUp()});b("#toc_sidebar .sidebar_contents_wrapper ul#toc_list li a").click(function(e){if(cp_toc_chapter_is_page=="0"){var d;d=b(this).parent().find("ul");if(d.length>0){if(cp_show_subpages=="0"){b(this).next("ul").slideToggle()}e.preventDefault()}}});b("#toc_sidebar .sidebar_contents_wrapper ul#nav li a").click(function(e){var d;d=b(this).parent().find("ul");if(d.length>0){b(this).next("ul").slideToggle();e.preventDefault()}});var c,a;c=b("#page_wrapper").css("min-height");a=b("#page_wrapper").css("padding-bottom");b("#literal .post").css("display","none");b("#original .post").css("display","none");b("#content-tabs li h2 a").click(function(e){var d;e.preventDefault();d=this.href.split("#")[1];b(".post").css("display","none");b(".workflow-wrapper").css("min-height","0");b(".workflow-wrapper").css("padding-bottom","0");b("#"+d+".workflow-wrapper").css("min-height",c);b("#"+d+".workflow-wrapper").css("padding-bottom",a);b("#"+d+" .post").css("display","block");b("#content-tabs li").removeClass("default-content-tab");b(this).parent().parent().addClass("default-content-tab")});b(document).on("commentpress-post-changed",function(f){var g,e,d;e=document.location.href;g=b(".editor_toggle a");if(g.length==0){return}d=g.attr("href");nonce=d.split("?")[1];e+="?"+nonce;g.attr("href",e)});if(cp_special_page=="1"){cp_scroll_to_comment_on_load()}else{cp_scroll_to_anchor_on_load()}jQuery(document).trigger("commentpress-document-ready")});