CommentPress.theme={},CommentPress.theme.settings=new function(){var e=this,t=jQuery.noConflict();this.init=function(){e.init_container_top_min(),e.init_container_top_min()},this.dom_ready=function(){t.cookie("cp_container_top_min")||(e.set_container_top_max(t.px_to_num(t("#container").css("top"))),e.save_container_top_max(),e.set_container_top_min(e.get_container_top_max()-CommentPress.theme.original.header.get_height()),e.save_container_top_min())},this.container_top_min=!1,this.init_container_top_max=function(){this.container_top_max=t.cookie("cp_container_top_max"),("undefined"==typeof this.container_top_max||null===this.container_top_max)&&(this.container_top_max=108),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(this.container_top_max=parseInt(this.container_top_max)+CommentPress.settings.DOM.get_wp_adminbar_height())},this.set_container_top_max=function(e){this.container_top_max=e},this.save_container_top_max=function(i){t.cookie("cp_container_top_max",e.get_container_top_max().toString(),{expires:28,path:cp_cookie_path})},this.get_container_top_max=function(){return this.container_top_max},this.container_top_min=!1,this.init_container_top_min=function(){this.container_top_min=t.cookie("cp_container_top_min"),("undefined"==typeof this.container_top_min||null===this.container_top_min)&&(this.container_top_min=108),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(this.container_top_min=parseInt(this.container_top_min)+CommentPress.settings.DOM.get_wp_adminbar_height())},this.set_container_top_min=function(e){this.container_top_min=e},this.save_container_top_min=function(i){t.cookie("cp_container_top_min",e.get_container_top_min().toString(),{expires:28,path:cp_cookie_path})},this.get_container_top_min=function(){return this.container_top_min},this.toc_on_top="n",this.set_toc_on_top=function(e){this.toc_on_top=e},this.get_toc_on_top=function(){return this.toc_on_top}},CommentPress.theme.DOM=new function(){var e=this,t=jQuery.noConflict();this.init=function(){e.head()},this.dom_ready=function(){e.layout()},this.head=function(){var e,i,n,s;e="",document.getElementById&&(e+='<style type="text/css" media="screen">',"0"==cp_is_mobile&&"0"==cp_textblock_meta&&(e+="#content .textblock span.para_marker, #content .textblock span.commenticonbox { display: none; } ",e+=".content .textblock span.para_marker, .content .textblock span.commenticonbox { display: none; } "),e+="ul.all_comments_listing div.item_body { display: none; } ","y"==CommentPress.settings.DOM.get_wp_adminbar()&&(e+="#header { top: "+CommentPress.settings.DOM.get_wp_adminbar_height()+"px; } ",e+="#book_header { top: "+(CommentPress.settings.DOM.get_wp_adminbar_height()+32)+"px; } ","32"==CommentPress.settings.DOM.get_wp_adminbar_height()&&(e+="@media screen and ( max-width: 782px ) { #header { top: "+CommentPress.settings.DOM.get_wp_adminbar_expanded()+"px; }#book_header { top: "+(CommentPress.settings.DOM.get_wp_adminbar_expanded()+32)+"px; } } ")),"0"==cp_show_subpages&&(e+="#toc_sidebar .sidebar_contents_wrapper ul li ul { display: none; } "),CommentPress.theme.original.header.is_minimised()?(i=CommentPress.theme.settings.get_container_top_max(),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(i=CommentPress.theme.settings.get_container_top_max()-CommentPress.settings.DOM.get_wp_adminbar_height()),e+="#container { top: "+i+"px; } ",e+="#sidebar { top: "+CommentPress.theme.settings.get_container_top_max()+"px; } ","y"==CommentPress.settings.DOM.get_wp_adminbar()&&"32"==CommentPress.settings.DOM.get_wp_adminbar_height()&&(e+="@media screen and ( max-width: 782px ) { #sidebar { top: "+(i+CommentPress.settings.DOM.get_wp_adminbar_expanded())+"px; } } ")):(e+="#book_header { display: none; } ",i=CommentPress.theme.settings.get_container_top_min(),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(i=CommentPress.theme.settings.get_container_top_min()-CommentPress.settings.DOM.get_wp_adminbar_height()),e+="#container { top: "+i+"px; } ",e+="#sidebar { top: "+CommentPress.theme.settings.get_container_top_min()+"px; } ","y"==CommentPress.settings.DOM.get_wp_adminbar()&&"32"==CommentPress.settings.DOM.get_wp_adminbar_height()&&(e+="@media screen and ( max-width: 782px ) { #sidebar { top: "+(i+CommentPress.settings.DOM.get_wp_adminbar_expanded())+"px; } } ")),"0"==cp_special_page&&(e+=".paragraph_wrapper { display: none; } ",e+="#respond { display: none; } ","y"==CommentPress.theme.sidebars.get_minimised()&&(e+="#comments_sidebar .sidebar_contents_wrapper { display: none; } ")),e+="#activity_sidebar .paragraph_wrapper { display: none; } ",t.cookie("cp_container_width")&&(n=t.cookie("cp_container_width"),e+="1"==cp_is_signup_page?"#content { width: "+n+"%; } ":"#page_wrapper { width: "+n+"%; } ",e+="#footer { width: "+n+"%; } "),t.cookie("cp_book_nav_width")&&(s=t.cookie("cp_book_nav_width"),e+="#book_nav div#cp_book_nav { width: "+s+"%; } "),t.cookie("cp_sidebar_width")&&(e+="#sidebar { width: "+t.cookie("cp_sidebar_width")+"%; } "),t.cookie("cp_sidebar_left")&&(e+="#sidebar { left: "+t.cookie("cp_sidebar_left")+"%; } "),e+="ul#sidebar_tabs, #toc_header.sidebar_header, body.blog_post #activity_header.sidebar_header { display: block; } ","1"==cp_is_mobile&&"0"==cp_is_tablet&&(e+=".sidebar_contents_wrapper { height: auto; } "),e+="</style>"),document.write(e)},this.layout=function(){var e;e=t("1"==cp_is_signup_page?"#content":"#page_wrapper"),e.each(function(e){var i,n,s,o,m,_,a,r,c,p,d,h,g;i=t(this),n=t("#content"),s=t("#sidebar"),o=t("#footer"),m=t("#book_header"),_=t("#book_nav_wrapper"),a=t("#cp_book_nav"),r=t("#cp_book_info"),c=i.width(),p=s.width(),g=s.offset().left-c,i.resizable({handles:"e",minWidth:cp_min_page_width,alsoResize:"#footer",start:function(e,t){c=i.width(),p=s.width(),d=a.width(),h=s.css("left"),g=s.offset().left-c},resize:function(e,t){var n;i.css("height","auto"),o.css("height","auto"),s.css("left",i.width()+g+"px"),n=c-i.width(),s.css("width",p+n+"px"),a.css("width",d-n+"px")},stop:function(e,o){var m,_,r,c,p,d,h;m=parseFloat(t(window).width()),_=i.width(),r=parseFloat(Math.ceil(1e6*parseFloat(_)/m)/1e4),i.css("width",r+"%"),"0"==cp_is_signup_page&&n.css("width","auto"),_=a.width(),c=parseFloat(Math.ceil(1e6*parseFloat(_)/m)/1e4),a.css("width",c+"%"),_=s.width(),p=parseFloat(Math.ceil(1e6*parseFloat(_)/m)/1e4),s.css("width",p+"%"),d=s.position().left,h=parseFloat(Math.ceil(1e6*parseFloat(d)/m)/1e4),s.css("left",h+"%"),t.cookie("cp_container_width",r.toString(),{expires:28,path:cp_cookie_path}),t.cookie("cp_book_nav_width",c.toString(),{expires:28,path:cp_cookie_path}),t.cookie("cp_sidebar_left",h.toString(),{expires:28,path:cp_cookie_path}),t.cookie("cp_sidebar_width",p.toString(),{expires:28,path:cp_cookie_path})}})})}},CommentPress.theme.header=new function(){var e=jQuery.noConflict();this.init=function(){},this.dom_ready=function(){},this.get_offset=function(){var t;return t=0-e.px_to_num(e("#container").css("top")),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(t-=CommentPress.settings.DOM.get_wp_adminbar_height()),t}},CommentPress.theme.navigation=new function(){var e=this,t=jQuery.noConflict();this.init=function(){},this.dom_ready=function(){e.menu()},this.menu=function(){t("#sidebar").on("click","#toc_header h2 a",function(e){e.preventDefault(),CommentPress.theme.sidebars.activate_sidebar("toc")})}},CommentPress.theme.content=new function(){var e=this,t=jQuery.noConflict();this.init=function(){},this.dom_ready=function(){e.tabs()},this.tabs=function(){var e,i;e=t("#content").css("min-height"),i=t("#content").css("padding-bottom"),t("#literal .post").css("display","none"),t("#original .post").css("display","none"),CommentPress.common.content.workflow_tabs(e,i)}},CommentPress.theme.sidebars=new function(){var e=this,t=jQuery.noConflict();this.init=function(){e.init_minimised()},this.dom_ready=function(){("0"==cp_is_mobile||"1"==cp_is_tablet)&&e.set_height()},this.minimised="n",this.init_minimised=function(){this.sidebar_minimised=t.cookie("cp_sidebar_minimised"),("undefined"==typeof this.sidebar_minimised||null===this.sidebar_minimised)&&(this.sidebar_minimised="n")},this.set_minimised=function(e){this.minimised=e},this.get_minimised=function(){return this.minimised},this.is_minimised=function(){return"undefined"==typeof this.minimised||null===this.minimised||"n"==this.minimised?"n":this.minimised},this.toggle_minimised=function(){"y"===this.minimised?this.minimised="n":this.minimised="y"},this.activate_sidebar=function(i){var n,s,o;n=t("#"+i+"_sidebar").css("z-index"),"2001"==n&&(t(".sidebar_container").css("z-index","2001"),t("#"+i+"_sidebar").css("z-index","2010"),s=e.get_top(),o=e.get_top_border(),t(".sidebar_header").css("height",s-o+"px"),t("#"+i+"_header.sidebar_header").css("height",s+"px"),CommentPress.theme.settings.set_toc_on_top("y")),"0"==cp_is_mobile||"1"==cp_is_tablet?e.set_height():(t(".sidebar_container").css("visibility","hidden"),t("#"+i+"_sidebar").css("visibility","visible"))},this.get_top=function(){return t.px_to_num(t("#toc_sidebar").css("top"))},this.get_top_border=function(){return t.px_to_num(t(".sidebar_minimiser").css("borderTopWidth"))},this.get_sidebar_pane=function(){var i=e.get_sidebar_name();return t("#"+i+"_sidebar .sidebar_minimiser")},this.get_sidebar_name=function(){var e="toc";return"comments"==cp_default_sidebar&&(e="comments","y"==CommentPress.theme.settings.get_toc_on_top()&&(e="toc")),"activity"==cp_default_sidebar&&(e="activity","y"==CommentPress.theme.settings.get_toc_on_top()&&(e="toc")),e},this.get_element_adjust=function(e){var i,n,s,o,m,_,a;return i=t.css_to_num(t.px_to_num(e.css("borderTopWidth"))),n=t.css_to_num(t.px_to_num(e.css("borderBottomWidth"))),s=t.css_to_num(t.px_to_num(e.css("padding-top"))),o=t.css_to_num(t.px_to_num(e.css("padding-bottom"))),m=t.css_to_num(t.px_to_num(e.css("margin-top"))),_=t.css_to_num(t.px_to_num(e.css("margin-bottom"))),a=i+n+s+o+m+_},this.set_height=function(){var i,n,s,o,m,_,a,r,c,p,d,h,g,l,u,b,f,C,P;return i=t("#sidebar"),n=t("#sidebar_inner"),s=t("#toc_sidebar"),o=t("#"+CommentPress.theme.sidebars.get_sidebar_name()+"_sidebar .sidebar_header"),m=e.get_sidebar_pane(),_=i.offset().top,a=e.get_element_adjust(i),r=e.get_element_adjust(n),c=_+a+r,p=s.position().top,d=e.get_element_adjust(s),h=p+d,g=0,"none"!=o.css("display")&&(g=o.height()+e.get_element_adjust(o)),l=e.get_element_adjust(m),u=t.css_to_num("1"==cp_is_signup_page?t.px_to_num(t("#content").css("margin-bottom")):t.px_to_num(t("#page_wrapper").css("margin-bottom"))),b=t(window).height(),f=t(window).scrollTop(),C=b+f,P=C-(c+h+g+l+u),t("#sidebar div.sidebar_contents_wrapper").css("height",P+"px"),P}},CommentPress.theme.viewport=new function(){var e=jQuery.noConflict();this.init=function(){},this.dom_ready=function(){},this.scroll_to_top=function(t,i){"undefined"!=typeof t&&("0"==cp_is_mobile||"1"==cp_is_tablet)&&e.scrollTo(t,i)},this.on_load_scroll_to_anchor=function(){var t,i,n,s,o,m,_,a,r,c,p;if(t="",i=document.location.toString(),i.match("#comment-")){if(CommentPress.theme.sidebars.activate_sidebar("comments"),n=i.split("#comment-")[1],s=e("#comment-"+n).parents("div.paragraph_wrapper").map(function(){return this}),s.length>0)return o=e(s[0]),"y"==cp_comments_open&&(t=o.prop("id").split("-")[1],m=e("#para_wrapper-"+t+" .reply_to_para").prop("id"),_=m.split("-")[1],a=e("#comment_post_ID").prop("value"),"1"==cp_tinymce?""!==e("#comment-"+n+" > .reply").text()&&(cp_tinymce="0",addComment.moveForm("comment-"+n,n,"respond",a,t),cp_tinymce="1"):addComment.moveForm("comment-"+n,n,"respond",a,t)),o.show(),CommentPress.common.comments.scroll_comments(e("#comment-"+n),1,"flash"),void(""!==t?(r=e("#textblock-"+t),e.highlight_para(r),CommentPress.common.content.scroll_page(r)):(CommentPress.settings.page.get_highlight()||CommentPress.theme.viewport.scroll_to_top(0,cp_scroll_speed),CommentPress.settings.page.toggle_highlight()))}else e("span.para_marker > a").each(function(t){var n,s,o,m,_;return n=e(this).prop("id"),i.match("#"+n)||i.match("#para_heading-"+n)?("y"==cp_comments_open&&(s=e("#para_wrapper-"+n+" .reply_to_para").prop("id"),o=s.split("-")[1],m=e("#comment_post_ID").prop("value"),addComment.moveFormToPara(o,n,m)),e("#para_heading-"+n).next("div.paragraph_wrapper").show(),CommentPress.common.comments.scroll_comments(e("#para_heading-"+n),1),_=e("#textblock-"+n),e.highlight_para(_),void CommentPress.common.content.scroll_page(_)):void 0});if(i.match("#respond"))return void e("h3#para_heading- a.comment_block_permalink").click();if(i.match("#")){if(c=i.split("#")[1],"edit=true"==c)return;if("fee-edit-link"==c)return;return p=e("#"+c),void(p.length&&(p.addClass("selected_para"),CommentPress.common.content.scroll_page(p)))}},this.align_content=function(t,i){if("none"!=i){CommentPress.theme.sidebars.activate_sidebar("comments");var n,s,o,m,_,a,r,c,p,d;if(n=e("#para_heading-"+t).next("div.paragraph_wrapper"),0!=n.length){if(s=e("#para_wrapper-"+t+" .commentlist"),o=n.find("#respond"),m=addComment.getLevel(),_=!1,a=n.css("display"),"none"==a&&(_=!0),e.unhighlight_para(),""!==t&&(r=e("#textblock-"+t),("1"!=cp_promote_reading||_)&&(e.highlight_para(r),CommentPress.common.content.scroll_page(r))),"0"==cp_promote_reading){if("y"==cp_comments_open&&(c=e("#comment_post_ID").prop("value"),p=e("#para_wrapper-"+t+" .reply_to_para").prop("id"),d=p.split("-")[1]),o[0]||"y"==cp_comments_open&&addComment.moveFormToPara(d,t,c),o[0]&&!m)return void("y"==cp_comments_open?(addComment.moveFormToPara(d,t,c),"para_heading"==i?CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed):CommentPress.common.comments.scroll_comments(e("#respond"),cp_scroll_speed)):CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed));if(!o[0]&&s[0]&&!_)return void("y"==cp_comments_open?"para_heading"==i?CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed):CommentPress.common.comments.scroll_comments(e("#respond"),cp_scroll_speed):CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed));if(!_&&s[0])return void("y"==cp_comments_open?"para_heading"==i?CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed):CommentPress.common.comments.scroll_comments(e("#respond"),cp_scroll_speed):CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed));if(o[0]&&!s[0]&&!_)return void("y"==cp_comments_open?"para_heading"==i?CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed):CommentPress.common.comments.scroll_comments(e("#respond"),cp_scroll_speed):CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed));_||s[0]||(n.css("display","none"),_=!0)}n.slideToggle("slow",function(){"1"==cp_promote_reading&&_?CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed):_&&("y"==cp_comments_open?"para_heading"==i?CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed):CommentPress.common.comments.scroll_comments(e("#respond"),cp_scroll_speed):CommentPress.common.comments.scroll_comments(e("#para_heading-"+t),cp_scroll_speed))})}}}},CommentPress.theme.original={},CommentPress.theme.original.header=new function(){var e=this,t=jQuery.noConflict(),i=!1;this.init=function(){e.init_minimised()},this.dom_ready=function(){e.init_height(),e.minimiser()},this.header_height=0,this.init_height=function(){this.header_height=t("#book_header").height()},this.set_height=function(e){this.header_height=e},this.get_height=function(){return this.header_height},this.minimised="n",this.init_minimised=function(){this.minimised=t.cookie("cp_header_minimised"),("undefined"==typeof this.minimised||null===this.minimised)&&(this.minimised="n")},this.set_minimised=function(e){this.minimised=e},this.get_minimised=function(){return this.minimised},this.is_minimised=function(){return"undefined"==typeof this.minimised||null===this.minimised||"n"==this.minimised?"n":this.minimised},this.toggle_minimised=function(){"y"===this.minimised?this.minimised="n":this.minimised="y"},this.minimiser=function(){t("#header").on("click","#btn_header_min",function(t){t.preventDefault(),e.toggle()})},this.toggle=function(){return i===!0?!1:(i=!0,e.is_minimised()?e.close():e.open(),e.toggle_minimised(),void t.cookie("cp_header_minimised",e.get_minimised(),{expires:28,path:cp_cookie_path}))},this.open=function(){var n,s,o,m,_,a,r;n=t("#book_nav").height(),s=t("#sidebar"),o=CommentPress.theme.sidebars.get_sidebar_pane(),m=t("#book_header"),_=t("#container"),a=CommentPress.theme.settings.get_container_top_max(),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(a=CommentPress.theme.settings.get_container_top_max()-CommentPress.settings.DOM.get_wp_adminbar_height()),_.animate({top:a+"px",duration:"fast"},function(){m.fadeIn("fast",function(){i=!1})}),"n"==CommentPress.theme.sidebars.get_minimised()?(r=s.height()-e.get_height(),s.animate({top:CommentPress.theme.settings.get_container_top_max()+"px",height:r+"px",duration:"fast"},function(){s.css("height","auto")}),o.animate({height:o.height()-e.get_height()+"px",duration:"fast"},function(){("0"==cp_is_mobile||"1"==cp_is_tablet)&&CommentPress.theme.sidebars.set_height(),i=!1})):s.animate({top:CommentPress.theme.settings.get_container_top_max()+"px",duration:"fast"},function(){i=!1,("0"==cp_is_mobile||"1"==cp_is_tablet)&&CommentPress.theme.sidebars.set_height()})},this.close=function(){var n,s,o,m,_,a,r;n=t("#book_nav").height(),s=t("#sidebar"),o=CommentPress.theme.sidebars.get_sidebar_pane(),m=t("#book_header"),_=t("#container"),m.hide(),a=CommentPress.theme.settings.get_container_top_min(),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(a=CommentPress.theme.settings.get_container_top_min()-CommentPress.settings.DOM.get_wp_adminbar_height()),_.animate({top:a+"px",duration:"fast"}),"n"==CommentPress.theme.sidebars.get_minimised()?(r=s.height()+e.get_height(),s.animate({top:CommentPress.theme.settings.get_container_top_min()+"px",height:r+"px",duration:"fast"},function(){s.css("height","auto")}),o.animate({height:o.height()+e.get_height()+"px",duration:"fast"},function(){("0"==cp_is_mobile||"1"==cp_is_tablet)&&CommentPress.theme.sidebars.set_height(),i=!1})):s.animate({top:CommentPress.theme.settings.get_container_top_min()+"px",duration:"fast"},function(){i=!1,("0"==cp_is_mobile||"1"==cp_is_tablet)&&CommentPress.theme.sidebars.set_height()})}},CommentPress.theme.settings.init(),CommentPress.theme.DOM.init(),CommentPress.theme.header.init(),CommentPress.theme.navigation.init(),CommentPress.theme.content.init(),CommentPress.theme.sidebars.init(),CommentPress.theme.viewport.init(),CommentPress.theme.original.header.init(),jQuery(document).ready(function(e){CommentPress.theme.settings.dom_ready(),CommentPress.theme.DOM.dom_ready(),CommentPress.theme.header.dom_ready(),CommentPress.theme.navigation.dom_ready(),CommentPress.theme.content.dom_ready(),CommentPress.theme.sidebars.dom_ready(),CommentPress.theme.viewport.dom_ready(),CommentPress.theme.original.header.dom_ready(),"1"==cp_special_page?CommentPress.common.content.on_load_scroll_to_comment():CommentPress.theme.viewport.on_load_scroll_to_anchor(),e(document).trigger("commentpress-document-ready")});