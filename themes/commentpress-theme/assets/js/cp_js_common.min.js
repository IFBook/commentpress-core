CommentPress.theme={},CommentPress.theme.settings=new function(){var e=this,t=jQuery.noConflict();this.init=function(){e.init_container_top_max(),e.init_container_top_min()},this.dom_ready=function(){t.cookie("cp_container_top_min")||(e.set_container_top_max(t.px_to_num(t("#container").css("top"))),e.save_container_top_max(),e.set_container_top_min(e.get_container_top_max()-CommentPress.theme.original.header.get_height()),e.save_container_top_min())},this.container_top_max=!1,this.init_container_top_max=function(){e.container_top_max=t.cookie("cp_container_top_max"),"undefined"!=typeof e.container_top_max&&null!==e.container_top_max||(e.container_top_max=108),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(e.container_top_max=parseInt(e.container_top_max)+CommentPress.settings.DOM.get_wp_adminbar_height())},this.set_container_top_max=function(t){e.container_top_max=t},this.save_container_top_max=function(){t.cookie("cp_container_top_max",e.get_container_top_max().toString(),{expires:28,path:cp_cookie_path})},this.get_container_top_max=function(){return e.container_top_max},this.container_top_min=!1,this.init_container_top_min=function(){e.container_top_min=t.cookie("cp_container_top_min"),"undefined"!=typeof e.container_top_min&&null!==e.container_top_min||(e.container_top_min=108),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(e.container_top_min=parseInt(e.container_top_min)+CommentPress.settings.DOM.get_wp_adminbar_height())},this.set_container_top_min=function(t){e.container_top_min=t},this.save_container_top_min=function(){t.cookie("cp_container_top_min",e.get_container_top_min().toString(),{expires:28,path:cp_cookie_path})},this.get_container_top_min=function(){return e.container_top_min},this.toc_on_top="n",this.set_toc_on_top=function(t){e.toc_on_top=t},this.get_toc_on_top=function(){return e.toc_on_top},this.comment_border="",this.set_comment_border=function(t){e.comment_border=t},this.get_comment_border=function(){return e.comment_border}},CommentPress.theme.DOM=new function(){var e=this,t=jQuery.noConflict();this.init=function(){e.head()},this.dom_ready=function(){e.layout()},this.head=function(){var e,n,o,i;e="",document.getElementById&&(e+='<style type="text/css" media="screen">',"0"==cp_is_mobile&&"0"==cp_textblock_meta&&(e+="#content .textblock span.para_marker, #content .textblock span.commenticonbox { display: none; } ",e+=".content .textblock span.para_marker, .content .textblock span.commenticonbox { display: none; } "),e+="ul.all_comments_listing div.item_body { display: none; } ","y"==CommentPress.settings.DOM.get_wp_adminbar()&&(e+="#header { top: "+CommentPress.settings.DOM.get_wp_adminbar_height()+"px; } ",e+="#book_header { top: "+(CommentPress.settings.DOM.get_wp_adminbar_height()+32)+"px; } ","32"==CommentPress.settings.DOM.get_wp_adminbar_height()&&(e+="@media screen and ( max-width: 782px ) { #header { top: "+CommentPress.settings.DOM.get_wp_adminbar_expanded()+"px; }#book_header { top: "+(CommentPress.settings.DOM.get_wp_adminbar_expanded()+32)+"px; } } ")),"0"==cp_show_subpages&&(e+="#toc_sidebar .sidebar_contents_wrapper ul li ul { display: none; } "),CommentPress.theme.original.header.is_minimised()?(e+="#book_header { display: none; } ",n=CommentPress.theme.settings.get_container_top_min(),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(n=CommentPress.theme.settings.get_container_top_min()-CommentPress.settings.DOM.get_wp_adminbar_height()),e+="#container { top: "+n+"px; } ",e+="#sidebar { top: "+CommentPress.theme.settings.get_container_top_min()+"px; } ","y"==CommentPress.settings.DOM.get_wp_adminbar()&&"32"==CommentPress.settings.DOM.get_wp_adminbar_height()&&(e+="@media screen and ( max-width: 782px ) { #sidebar { top: "+(n+CommentPress.settings.DOM.get_wp_adminbar_expanded())+"px; } } ")):(n=CommentPress.theme.settings.get_container_top_max(),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(n=CommentPress.theme.settings.get_container_top_max()-CommentPress.settings.DOM.get_wp_adminbar_height()),e+="#container { top: "+n+"px; } ",e+="#sidebar { top: "+CommentPress.theme.settings.get_container_top_max()+"px; } ","y"==CommentPress.settings.DOM.get_wp_adminbar()&&"32"==CommentPress.settings.DOM.get_wp_adminbar_height()&&(e+="@media screen and ( max-width: 782px ) { #sidebar { top: "+(n+CommentPress.settings.DOM.get_wp_adminbar_expanded())+"px; } } ")),"0"==cp_special_page&&(e+=".paragraph_wrapper { display: none; } ",e+="#respond { display: none; } ","y"==CommentPress.theme.sidebars.get_minimised()&&(e+="#comments_sidebar .sidebar_contents_wrapper { display: none; } ")),e+="#activity_sidebar .paragraph_wrapper { display: none; } ",t.cookie("cp_container_width")&&(o=t.cookie("cp_container_width"),e+="#page_wrapper { width: "+o+"%; } ",e+="#footer { width: "+o+"%; } "),t.cookie("cp_book_nav_width")&&(i=t.cookie("cp_book_nav_width"),e+="#book_nav div#cp_book_nav { width: "+i+"%; } "),t.cookie("cp_sidebar_width")&&(e+="#sidebar { width: "+t.cookie("cp_sidebar_width")+"%; } "),t.cookie("cp_sidebar_left")&&(e+="#sidebar { left: "+t.cookie("cp_sidebar_left")+"%; } "),e+="ul#sidebar_tabs, #toc_header.sidebar_header, body.blog_post #activity_header.sidebar_header { display: block; } ","1"==cp_is_mobile&&"0"==cp_is_tablet&&(e+=".sidebar_contents_wrapper { height: auto; } "),e+="</style>"),document.write(e)},this.layout=function(){var e;e=t("#page_wrapper"),e.each(function(){var e,n,o,i,s,m,r,_,a,c,p,d,h;e=t(this),n=t("#content"),o=t("#sidebar"),i=t("#footer"),s=t("#book_header"),m=t("#book_nav_wrapper"),r=t("#cp_book_nav"),_=t("#cp_book_info"),a=e.width(),c=o.width(),h=o.offset().left-a,e.resizable({handles:"e",minWidth:cp_min_page_width,alsoResize:"#footer",start:function(){a=e.width(),c=o.width(),p=r.width(),d=o.css("left"),h=o.offset().left-a},resize:function(){var t;e.css("height","auto"),i.css("height","auto"),o.css("left",e.width()+h+"px"),t=a-e.width(),o.css("width",c+t+"px"),r.css("width",p-t+"px")},stop:function(){var i,s,m,_,a,c,p;i=parseFloat(t(window).width()),s=e.width(),m=parseFloat(Math.ceil(1e6*parseFloat(s)/i)/1e4),e.css("width",m+"%"),n.css("width","auto"),s=r.width(),_=parseFloat(Math.ceil(1e6*parseFloat(s)/i)/1e4),r.css("width",_+"%"),s=o.width(),a=parseFloat(Math.ceil(1e6*parseFloat(s)/i)/1e4),o.css("width",a+"%"),c=o.position().left,p=parseFloat(Math.ceil(1e6*parseFloat(c)/i)/1e4),o.css("left",p+"%"),t.cookie("cp_container_width",m.toString(),{expires:28,path:cp_cookie_path}),t.cookie("cp_book_nav_width",_.toString(),{expires:28,path:cp_cookie_path}),t.cookie("cp_sidebar_left",p.toString(),{expires:28,path:cp_cookie_path}),t.cookie("cp_sidebar_width",a.toString(),{expires:28,path:cp_cookie_path})}})})}},CommentPress.theme.header=new function(){var e=jQuery.noConflict();this.init=function(){},this.dom_ready=function(){},this.get_offset=function(){var t;return t=0-e.px_to_num(e("#container").css("top")),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(t-=CommentPress.settings.DOM.get_wp_adminbar_height()),t}},CommentPress.theme.navigation=new function(){var e=this,t=jQuery.noConflict();this.init=function(){},this.dom_ready=function(){e.menu()},this.menu=function(){t("#sidebar").on("click","#toc_header h2 a",function(e){e.preventDefault(),CommentPress.theme.sidebars.activate_sidebar("toc")})}},CommentPress.theme.content=new function(){var e=this,t=jQuery.noConflict();this.init=function(){},this.dom_ready=function(){e.tabs()},this.tabs=function(){var e,n;e=t("#content").css("min-height"),n=t("#content").css("padding-bottom"),t("#literal .post").css("display","none"),t("#original .post").css("display","none"),CommentPress.common.content.workflow_tabs(e,n)}},CommentPress.theme.sidebars=new function(){var e=this,t=jQuery.noConflict();this.init=function(){e.init_minimised()},this.dom_ready=function(){"0"!=cp_is_mobile&&"1"!=cp_is_tablet||e.set_height()},this.minimised="n",this.init_minimised=function(){e.sidebar_minimised=t.cookie("cp_sidebar_minimised"),"undefined"!=typeof e.sidebar_minimised&&null!==e.sidebar_minimised||(e.sidebar_minimised="n")},this.set_minimised=function(t){e.minimised=t},this.get_minimised=function(){return e.minimised},this.is_minimised=function(){return"undefined"==typeof e.minimised||null===e.minimised||"n"==e.minimised?"n":e.minimised},this.toggle_minimised=function(){"y"===e.minimised?e.minimised="n":e.minimised="y"},this.activate_sidebar=function(n){var o,i,s;o=t("#"+n+"_sidebar").css("z-index"),"2001"==o&&(t(".sidebar_container").css("z-index","2001"),t("#"+n+"_sidebar").css("z-index","2010"),i=e.get_top(),s=e.get_top_border(),t(".sidebar_header").css("height",i-s+"px"),t("#"+n+"_header.sidebar_header").css("height",i+"px"),CommentPress.theme.settings.set_toc_on_top("y")),"0"==cp_is_mobile||"1"==cp_is_tablet?e.set_height():(t(".sidebar_container").css("visibility","hidden"),t("#"+n+"_sidebar").css("visibility","visible"))},this.get_top=function(){return t.px_to_num(t("#toc_sidebar").css("top"))},this.get_top_border=function(){return t.px_to_num(t(".sidebar_minimiser").css("borderTopWidth"))},this.get_sidebar_pane=function(){var n=e.get_sidebar_name();return t("#"+n+"_sidebar .sidebar_minimiser")},this.get_sidebar_name=function(){var e="toc";return"comments"==cp_default_sidebar&&(e="comments","y"==CommentPress.theme.settings.get_toc_on_top()&&(e="toc")),"activity"==cp_default_sidebar&&(e="activity","y"==CommentPress.theme.settings.get_toc_on_top()&&(e="toc")),e},this.get_element_adjust=function(e){var n,o,i,s,m,r,_;return n=t.css_to_num(t.px_to_num(e.css("borderTopWidth"))),o=t.css_to_num(t.px_to_num(e.css("borderBottomWidth"))),i=t.css_to_num(t.px_to_num(e.css("padding-top"))),s=t.css_to_num(t.px_to_num(e.css("padding-bottom"))),m=t.css_to_num(t.px_to_num(e.css("margin-top"))),r=t.css_to_num(t.px_to_num(e.css("margin-bottom"))),_=n+o+i+s+m+r},this.set_height=function(){var n,o,i,s,m,r,_,a,c,p,d,h,g,l,u,b,f,C,P;return n=t("#sidebar"),o=t("#sidebar_inner"),i=t("#toc_sidebar"),s=t("#"+CommentPress.theme.sidebars.get_sidebar_name()+"_sidebar .sidebar_header"),m=e.get_sidebar_pane(),r=n.offset().top,_=e.get_element_adjust(n),a=e.get_element_adjust(o),c=r+_+a,p=i.position().top,d=e.get_element_adjust(i),h=p+d,g=0,"none"!=s.css("display")&&(g=s.height()+e.get_element_adjust(s)),l=e.get_element_adjust(m),u=t.css_to_num(t.px_to_num(t("#page_wrapper").css("margin-bottom"))),b=t(window).height(),f=t(window).scrollTop(),C=b+f,P=C-(c+h+g+l+u),t("#sidebar div.sidebar_contents_wrapper").css("height",P+"px"),P}},CommentPress.theme.viewport=new function(){var e=this,t=jQuery.noConflict();this.init=function(){},this.dom_ready=function(){},this.scroll_to_top=function(e,n){"undefined"!=typeof e&&("0"!=cp_is_mobile&&"1"!=cp_is_tablet||t(window).stop(!0).scrollTo(e,n))},this.on_load_scroll_to_anchor=function(){var n,o,i,s,m,r;if(n="",r=!1,o=document.location.toString(),o.match("#comment-"))return tmp=o.split("#comment-"),i=0,2==tmp.length&&(i=parseInt(tmp[1])),0!==i&&e.on_load_scroll_to_comment(i),void CommentPress.common.DOM.location_reset();if(t("span.para_marker > a").each(function(){var n;n=t(this).prop("id"),(o.match("#"+n)||o.match("#para_heading-"+n))&&(e.align_content(n,"para_heading"),CommentPress.common.DOM.location_reset(),r=!0)}),r!==!0){if(o.match("#respond"))return o.match("replytocom")?(comment_parent=parseInt(t("#comment_parent").val()),e.on_load_scroll_to_comment(comment_parent)):o.match("replytopara")?(n=t("#text_signature").val(),e.align_content(n,"commentform")):t("h3#para_heading- a.comment_block_permalink").click(),void CommentPress.common.DOM.location_reset();if(o.match("#")){if(s=o.split("#")[1],"edit=true"==s)return;if("fee-edit-link"==s)return;return m=t("#"+s),m.length&&(m.addClass("selected_para"),CommentPress.common.content.scroll_page(m)),void CommentPress.common.DOM.location_reset()}}},this.on_load_scroll_to_comment=function(e){var n,o,i,s,m,r,_;CommentPress.theme.sidebars.activate_sidebar("comments"),o=t("#comment-"+e).parents("div.paragraph_wrapper").map(function(){return this}),o.length>0&&(i=t(o[0]),n=i.prop("id").split("-")[1],"y"==cp_comments_open&&(s=t("#para_wrapper-"+n+" .reply_to_para").prop("id"),m=s.split("-")[1],r=t("#comment_post_ID").prop("value"),"1"==cp_tinymce?""!==t("#comment-"+e+" > .reply").text()&&(cp_tinymce="0",addComment.moveForm("comment-"+e,e,"respond",r,n),cp_tinymce="1"):addComment.moveForm("comment-"+e,e,"respond",r,n)),i.show(),CommentPress.common.comments.scroll_comments(t("#comment-"+e),1,"flash"),""!==n?(_=t("#textblock-"+n),t.highlight_para(_),CommentPress.common.content.scroll_page(_)):(CommentPress.settings.page.get_highlight()||CommentPress.theme.viewport.scroll_to_top(0,cp_scroll_speed),CommentPress.settings.page.toggle_highlight()))},this.align_content=function(e,n){if("none"!=n){CommentPress.theme.sidebars.activate_sidebar("comments");var o,i,s,m,r,_,a,c,p,d;if(o=t("#para_heading-"+e).next("div.paragraph_wrapper"),0!=o.length){if(i=t("#para_wrapper-"+e+" .commentlist"),s=o.find("#respond"),m=addComment.getLevel(),r=!1,_=o.css("display"),"none"==_&&(r=!0),t.unhighlight_para(),""!==e&&(a=t("#textblock-"+e),("1"!=cp_promote_reading||r)&&(t.highlight_para(a),CommentPress.common.content.scroll_page(a))),"0"==cp_promote_reading){if("y"==cp_comments_open&&(c=t("#comment_post_ID").prop("value"),p=t("#para_wrapper-"+e+" .reply_to_para").prop("id"),d=p.split("-")[1]),s[0]||"y"==cp_comments_open&&addComment.moveFormToPara(d,e,c),s[0]&&!m)return void("y"==cp_comments_open?(addComment.moveFormToPara(d,e,c),"para_heading"==n?CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed):CommentPress.common.comments.scroll_comments(t("#respond"),cp_scroll_speed)):CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed));if(!s[0]&&i[0]&&!r)return void("y"==cp_comments_open?"para_heading"==n?CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed):CommentPress.common.comments.scroll_comments(t("#respond"),cp_scroll_speed):CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed));if(!r&&i[0])return void("y"==cp_comments_open?"para_heading"==n?CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed):CommentPress.common.comments.scroll_comments(t("#respond"),cp_scroll_speed):CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed));if(s[0]&&!i[0]&&!r)return void("y"==cp_comments_open?"para_heading"==n?CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed):CommentPress.common.comments.scroll_comments(t("#respond"),cp_scroll_speed):CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed));r||i[0]||(o.css("display","none"),r=!0)}o.slideToggle("slow",function(){"1"==cp_promote_reading&&r?CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed):r&&("y"==cp_comments_open?"para_heading"==n?CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed):CommentPress.common.comments.scroll_comments(t("#respond"),cp_scroll_speed):CommentPress.common.comments.scroll_comments(t("#para_heading-"+e),cp_scroll_speed))})}}}},CommentPress.theme.original={},CommentPress.theme.original.header=new function(){var e=this,t=jQuery.noConflict(),n=!1;this.init=function(){e.init_minimised()},this.dom_ready=function(){e.init_height(),e.minimiser()},this.header_height=0,this.init_height=function(){e.header_height=t("#book_header").height()},this.set_height=function(t){e.header_height=t},this.get_height=function(){return e.header_height},this.minimised="n",this.init_minimised=function(){e.minimised=t.cookie("cp_header_minimised"),"undefined"!=typeof e.minimised&&null!==e.minimised||(e.minimised="n")},this.set_minimised=function(t){e.minimised=t},this.get_minimised=function(){return e.minimised},this.is_minimised=function(){return"undefined"!=typeof e.minimised&&null!==e.minimised&&"n"!=e.minimised},this.toggle_minimised=function(){"y"===e.minimised?e.minimised="n":e.minimised="y"},this.minimiser=function(){t("#header").on("click","#btn_header_min",function(t){t.preventDefault(),e.toggle()})},this.toggle=function(){return n===!0?!1:(n=!0,e.is_minimised()?e.open():e.close(),e.toggle_minimised(),void t.cookie("cp_header_minimised",e.get_minimised(),{expires:28,path:cp_cookie_path}))},this.open=function(){var o,i,s,m,r,_,a;o=t("#book_nav").height(),i=t("#sidebar"),s=CommentPress.theme.sidebars.get_sidebar_pane(),m=t("#book_header"),r=t("#container"),_=CommentPress.theme.settings.get_container_top_max(),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(_=CommentPress.theme.settings.get_container_top_max()-CommentPress.settings.DOM.get_wp_adminbar_height()),r.animate({top:_+"px",duration:"fast"},function(){m.fadeIn("fast",function(){n=!1})}),"n"==CommentPress.theme.sidebars.get_minimised()?(a=i.height()-e.get_height(),i.animate({top:CommentPress.theme.settings.get_container_top_max()+"px",height:a+"px",duration:"fast"},function(){i.css("height","auto")}),s.animate({height:s.height()-e.get_height()+"px",duration:"fast"},function(){"0"!=cp_is_mobile&&"1"!=cp_is_tablet||CommentPress.theme.sidebars.set_height(),n=!1})):i.animate({top:CommentPress.theme.settings.get_container_top_max()+"px",duration:"fast"},function(){n=!1,"0"!=cp_is_mobile&&"1"!=cp_is_tablet||CommentPress.theme.sidebars.set_height()})},this.close=function(){var o,i,s,m,r,_,a;o=t("#book_nav").height(),i=t("#sidebar"),s=CommentPress.theme.sidebars.get_sidebar_pane(),m=t("#book_header"),r=t("#container"),m.hide(),_=CommentPress.theme.settings.get_container_top_min(),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(_=CommentPress.theme.settings.get_container_top_min()-CommentPress.settings.DOM.get_wp_adminbar_height()),r.animate({top:_+"px",duration:"fast"}),"n"==CommentPress.theme.sidebars.get_minimised()?(a=i.height()+e.get_height(),i.animate({top:CommentPress.theme.settings.get_container_top_min()+"px",height:a+"px",duration:"fast"},function(){i.css("height","auto")}),s.animate({height:s.height()+e.get_height()+"px",duration:"fast"},function(){"0"!=cp_is_mobile&&"1"!=cp_is_tablet||CommentPress.theme.sidebars.set_height(),n=!1})):i.animate({top:CommentPress.theme.settings.get_container_top_min()+"px",duration:"fast"},function(){n=!1,"0"!=cp_is_mobile&&"1"!=cp_is_tablet||CommentPress.theme.sidebars.set_height()})}},CommentPress.theme.settings.init(),CommentPress.theme.original.header.init(),CommentPress.theme.DOM.init(),CommentPress.theme.header.init(),CommentPress.theme.navigation.init(),CommentPress.theme.content.init(),CommentPress.theme.sidebars.init(),CommentPress.theme.viewport.init(),jQuery(document).ready(function(e){CommentPress.theme.original.header.dom_ready(),CommentPress.theme.settings.dom_ready(),CommentPress.theme.DOM.dom_ready(),CommentPress.theme.header.dom_ready(),CommentPress.theme.navigation.dom_ready(),CommentPress.theme.content.dom_ready(),CommentPress.theme.sidebars.dom_ready(),CommentPress.theme.viewport.dom_ready(),e(document).on("commentpress-comment-highlight",function(e,t){var n;jQuery("#li-comment-"+t+" > .comment-wrapper").css("background-color","#CBFFBD"),n=jQuery("#comment-"+t+" > .comment-content").css("border-bottom"),CommentPress.theme.settings.set_comment_border(n),jQuery("#comment-"+t+" > .comment-content").css("border-bottom","1px dashed #b8b8b8")}),e(document).on("commentpress-comment-unhighlight",function(e,t){var n;n=CommentPress.theme.settings.get_comment_border(),jQuery("#li-comment-"+t+" > .comment-wrapper").css("background-color","#fff"),jQuery("#comment-"+t+" > .comment-content").css("border-bottom",n)}),e(document).on("commentpress-comment-highlights-clear",function(){var e;e=CommentPress.theme.settings.get_comment_border(),jQuery(".comment-wrapper").css("background-color","#fff"),jQuery(".comment-content").css("border-bottom",e)}),"1"==cp_special_page?CommentPress.common.content.on_load_scroll_to_comment():CommentPress.theme.viewport.on_load_scroll_to_anchor(),e(document).trigger("commentpress-document-ready")});
