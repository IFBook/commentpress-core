function commentpress_setup_init(){CommentPress.setup.navigation.init(),CommentPress.setup.content.init(),CommentPress.setup.comments.init(),CommentPress.setup.activity.init(),jQuery(document).trigger("commentpress-initialised")}var msie_detected=!1;if("undefined"!=typeof cp_msie&&(msie_detected=!0),"undefined"!=typeof CommentpressSettings){var cp_comments_open,cp_special_page,cp_tinymce,cp_tinymce_version,cp_promote_reading,cp_is_mobile,cp_is_touch,cp_is_tablet,cp_cookie_path,cp_multipage_page,cp_template_dir,cp_plugin_dir,cp_toc_chapter_is_page,cp_show_subpages,cp_default_sidebar,cp_is_signup_page,cp_scroll_speed,cp_min_page_width,cp_textblock_meta;cp_comments_open=CommentpressSettings.cp_comments_open,cp_special_page=CommentpressSettings.cp_special_page,cp_tinymce=CommentpressSettings.cp_tinymce,cp_tinymce_version=CommentpressSettings.cp_tinymce_version,cp_promote_reading=CommentpressSettings.cp_promote_reading,cp_is_mobile=CommentpressSettings.cp_is_mobile,cp_is_touch=CommentpressSettings.cp_is_touch,cp_is_tablet=CommentpressSettings.cp_is_tablet,cp_cookie_path=CommentpressSettings.cp_cookie_path,cp_multipage_page=CommentpressSettings.cp_multipage_page,cp_template_dir=CommentpressSettings.cp_template_dir,cp_plugin_dir=CommentpressSettings.cp_plugin_dir,cp_toc_chapter_is_page=CommentpressSettings.cp_toc_chapter_is_page,cp_show_subpages=CommentpressSettings.cp_show_subpages,cp_default_sidebar=CommentpressSettings.cp_default_sidebar,cp_is_signup_page=CommentpressSettings.cp_is_signup_page,cp_scroll_speed=CommentpressSettings.cp_js_scroll_speed,cp_min_page_width=CommentpressSettings.cp_min_page_width,cp_textblock_meta=CommentpressSettings.cp_textblock_meta}var CommentPress=CommentPress||{};CommentPress.settings={},CommentPress.settings.DOM=new function(){{var t=this;jQuery.noConflict()}this.init=function(){t.init_wp_adminbar(),t.init_bp_adminbar(),t.init_wp_adminbar_height()},this.bp_adminbar="n",this.init_bp_adminbar=function(t){"undefined"!=typeof CommentpressSettings&&(this.bp_adminbar=CommentpressSettings.cp_bp_adminbar)},this.set_bp_adminbar=function(t){this.bp_adminbar=t},this.get_bp_adminbar=function(){return this.bp_adminbar},this.wp_adminbar="n",this.init_wp_adminbar=function(t){"undefined"!=typeof CommentpressSettings&&(this.wp_adminbar=CommentpressSettings.cp_wp_adminbar)},this.set_wp_adminbar=function(t){this.wp_adminbar=t},this.get_wp_adminbar=function(){return this.wp_adminbar},this.wp_adminbar_height=0,this.init_wp_adminbar_height=function(e){"undefined"!=typeof CommentpressSettings&&(this.wp_adminbar_height=parseInt(CommentpressSettings.cp_wp_adminbar_height)),"y"==t.get_bp_adminbar()&&(this.wp_adminbar_height=25,t.set_wp_adminbar("y"))},this.set_wp_adminbar_height=function(t){this.wp_adminbar_height=t},this.get_wp_adminbar_height=function(){return this.wp_adminbar_height},this.wp_adminbar_height=0,this.init_wp_adminbar_expanded=function(t){"undefined"!=typeof CommentpressSettings&&(this.wp_adminbar_expanded=parseInt(CommentpressSettings.cp_wp_adminbar_expanded))},this.set_wp_adminbar_expanded=function(t){this.wp_adminbar_expanded=t},this.get_wp_adminbar_expanded=function(){return this.wp_adminbar_expanded}},CommentPress.settings.page=new function(){jQuery.noConflict();this.init=function(){},this.highlight=!1,this.toggle_highlight=function(){this.highlight=!this.highlight},this.set_highlight=function(t){this.highlight=t},this.get_highlight=function(){return this.highlight}},CommentPress.settings.textblock=new function(){this.marker_mode="marker",this.setMarkerMode=function(t){this.marker_mode=t},this.getMarkerMode=function(){return this.marker_mode}},CommentPress.setup={},CommentPress.setup.navigation=new function(){var t=this,e=jQuery.noConflict();this.init=function(){t.headings(),t.menu()},this.headings=function(){e("h3.activity_heading").css("cursor","pointer"),e("#toc_sidebar").on("click","h3.activity_heading",function(t){var n;t.preventDefault(),n=e(this).next("div.paragraph_wrapper"),n.css("width",e(this).parent().css("width")),n.slideToggle("slow",function(){n.css("width","auto")})})},this.menu=function(){e("#toc_sidebar").on("click","ul#toc_list li a",function(t){if("0"==cp_toc_chapter_is_page){var n;n=e(this).parent().find("ul"),n.length>0&&("0"==cp_show_subpages&&e(this).next("ul").slideToggle(),t.preventDefault())}})}},CommentPress.setup.content=new function(){var t=this,e=jQuery.noConflict();this.init=function(){t.title_links(),t.textblocks(),t.para_markers(),t.comment_icons(),t.links_in_textblocks(),t.footnotes_compatibility()},this.title_links=function(){e("#container").on("click",".post_title a",function(t){t.preventDefault();var e="";CommentPress.theme.viewport.align_content(e,"marker")})},this.textblocks=function(){"0"==cp_is_mobile&&"0"==cp_textblock_meta&&(e("#container").on("mouseover",".textblock",function(t){e(this).addClass("textblock-in")}),e("#container").on("mouseout",".textblock",function(t){e(this).removeClass("textblock-in")})),e("#container").on("click",".textblock",function(t){var n;n=e(this).prop("id"),n=n.split("textblock-")[1],CommentPress.theme.viewport.align_content(n,CommentPress.settings.textblock.getMarkerMode()),e(document).trigger("commentpress-textblock-clicked")})},this.para_markers=function(){e("#container").on("click","span.para_marker a",function(t){t.preventDefault(),e(document).trigger("commentpress-paramarker-clicked")}),e("#container").on("mouseenter","span.para_marker a",function(t){var n;n=e(this).parent().next().children(".comment_count"),n.addClass("js-hover")}),e("#container").on("mouseleave","span.para_marker a",function(t){var n;n=e(this).parent().next().children(".comment_count"),n.removeClass("js-hover")})},this.comment_icons=function(){e("#container").on("click",".commenticonbox",function(t){var n;t.preventDefault(),t.stopPropagation(),n=e(this).children("a.para_permalink").prop("href").split("#")[1],CommentPress.theme.viewport.align_content(n,"auto"),e(document).trigger("commentpress-commenticonbox-clicked")}),e("#container").on("click","a.para_permalink",function(t){t.preventDefault()}),e("#container").on("mouseenter","a.para_permalink",function(t){var n;n=e(this).prop("href").split("#")[1],e("span.para_marker a#"+n).addClass("js-hover")}),e("#container").on("mouseleave","a.para_permalink",function(t){var n;n=e(this).prop("href").split("#")[1],e("span.para_marker a#"+n).removeClass("js-hover")})},this.links_in_textblocks=function(){e("#container").on("click","a.cp_para_link",function(t){var n;t.preventDefault(),n=e(this).prop("href").split("#")[1],CommentPress.theme.viewport.align_content(n,"auto")})},this.footnotes_compatibility=function(){e("#container").on("click","span.footnotereverse a, a.footnote-back-link",function(t){var n;t.preventDefault(),n=e(this).prop("href").split("#")[1],e.quick_scroll_page("#"+n,100)}),e("#container").on("click",".simple-footnotes ol li > a",function(t){var n;n=e(this).prop("href"),n.match("#return-note-")&&(t.preventDefault(),n=n.split("#")[1],e.quick_scroll_page("#"+n,100))}),e("#container").on("click","a.simple-footnote, sup.footnote a, sup a.footnote-identifier-link, a.zp-ZotpressInText",function(t){var n;t.preventDefault(),n=e(this).prop("href").split("#")[1],e.quick_scroll_page("#"+n,100)})},this.workflow_tabs=function(t,n){e("#literal .post").css("display","none"),e("#original .post").css("display","none"),e("#container").on("click","content-tabs li h2 a",function(i){var s;i.preventDefault(),s=this.href.split("#")[1],e(".post").css("display","none"),e(".workflow-wrapper").css("min-height","0"),e(".workflow-wrapper").css("padding-bottom","0"),e("#"+s+".workflow-wrapper").css("min-height",t),e("#"+s+".workflow-wrapper").css("padding-bottom",n),e("#"+s+" .post").css("display","block"),e("#content-tabs li").removeClass("default-content-tab"),e(this).parent().parent().addClass("default-content-tab")})}},CommentPress.setup.comments=new function(){var t=this,e=jQuery.noConflict();this.init=function(){t.header(),t.minimiser(),t.comment_block_permalinks(),t.comment_permalinks(),t.comment_permalink_copy_links()},this.header=function(){e("#sidebar").on("click","#comments_header h2 a",function(t){t.preventDefault(),CommentPress.theme.sidebars.activate_sidebar("comments")})},this.minimiser=function(){e("#sidebar").on("click","#cp_minimise_all_comments",function(t){t.preventDefault(),e("#comments_sidebar div.paragraph_wrapper").slideUp(),e.unhighlight_para()})},this.comment_block_permalinks=function(){"1"!=cp_special_page&&(e("a.comment_block_permalink").css("cursor","pointer"),e("#comments_sidebar").on("click","a.comment_block_permalink",function(t){var n,i,s,o,a,r,c,p,_,m;t.preventDefault(),n=e(this).parent().prop("id").split("para_heading-")[1],i=e(this).parent().next("div.paragraph_wrapper"),s=e("#para_wrapper-"+n).find("ol.commentlist"),o=!1,a=i.css("display"),"none"==a&&(o=!0),"undefined"!=typeof n&&(""!==n&&"pingbacksandtrackbacks"!=n?(r=e("#textblock-"+n),o?(e.unhighlight_para(),e.highlight_para(r),e.scroll_page(r)):"0"==cp_promote_reading?e("#para_wrapper-"+n).find("#respond")[0]?e.unhighlight_para():s[0]||(e.unhighlight_para(),e.highlight_para(r),e.scroll_page(r)):e.is_highlighted(r)&&e.unhighlight_para()):(e.unhighlight_para(),"pingbacksandtrackbacks"!=n&&(CommentPress.theme.viewport.scroll_to_top(0,cp_scroll_speed),CommentPress.settings.page.toggle_highlight()))),"0"==cp_promote_reading&&"pingbacksandtrackbacks"!=n&&"y"==cp_comments_open&&(c=e("#comment_post_ID").prop("value"),p=e("#para_wrapper-"+n+" .reply_to_para").prop("id"),_=p.split("-")[1],m=e("#para_wrapper-"+n).find("#respond")[0],s.length>0&&s[0]?(o||m)&&addComment.moveFormToPara(_,n,c):(m||(i.css("display","none"),o=!0),addComment.moveFormToPara(_,n,c))),i.slideToggle("slow",function(){o&&e.scroll_comments(e("#para_heading-"+n),cp_scroll_speed)})}))},this.comment_permalinks=function(){e("#comments_sidebar").on("click",".comment_permalink",function(t){var n,i,s;t.preventDefault(),n=this.href.split("#")[1],"1"==cp_special_page?(i=CommentPress.theme.header.get_offset(),e.scrollTo(e("#"+n),{duration:cp_scroll_speed,axis:"y",offset:i})):(e.unhighlight_para(),s=e.get_text_sig_by_comment_id("#"+n),"pingbacksandtrackbacks"!=s&&e.scroll_page_to_textblock(s),e.scroll_comments(e("#"+n),cp_scroll_speed))})},this.comment_permalink_copy_links=function(){e("#comments_sidebar").on("click",".comment_permalink_copy",function(t){var n;n=e(this).parent().attr("href"),n&&window.prompt("Copy this link, then paste into where you need it",n)})},this.comment_rollovers=function(){e("#comments_sidebar").on("mouseenter",".comment-wrapper",function(t){e(this).addClass("background-highlight")}),e("#comments_sidebar").on("mouseleave",".comment-wrapper",function(t){e(this).removeClass("background-highlight")})},this.highlight=function(t){t.addClass("notransition"),t.hasClass("comment-fade")&&t.removeClass("comment-fade"),t.hasClass("comment-highlighted")&&t.removeClass("comment-highlighted"),t.addClass("comment-highlighted"),t.removeClass("notransition"),t.height(),t.addClass("comment-fade")}},CommentPress.setup.activity=new function(){var t=this,e=jQuery.noConflict();this.init=function(){t.header(),t.minimiser(),t.headings(),t.see_in_context_links()},this.header=function(){e("#sidebar").on("click","#activity_header h2 a",function(t){t.preventDefault(),CommentPress.theme.sidebars.activate_sidebar("activity")})},this.minimiser=function(){e("#sidebar").on("click","#cp_minimise_all_activity",function(t){t.preventDefault(),e("#activity_sidebar div.paragraph_wrapper").slideUp()})},this.headings=function(){e("h3.activity_heading").css("cursor","pointer"),e("#activity_sidebar").on("click","h3.activity_heading",function(t){var n;t.preventDefault(),n=e(this).next("div.paragraph_wrapper"),n.css("width",e(this).parent().css("width")),n.slideToggle("slow",function(){n.css("width","auto")})})},this.see_in_context_links=function(){"1"!=cp_special_page&&e("#activity_sidebar").on("click","a.comment_on_post",function(t){var n,i,s,o,a,r;t.preventDefault(),CommentPress.theme.sidebars.activate_sidebar("comments"),n=this.href.split("#")[1],i=e("#"+n),s=i.parents("div.paragraph_wrapper").map(function(){return this}),s.length>0&&(o=e(s[0]),o.show(),"1"==cp_special_page?(a=CommentPress.theme.header.get_offset(),e.scrollTo(i,{duration:cp_scroll_speed,axis:"y",offset:a})):(e.unhighlight_para(),r=o.prop("id").split("-")[1],e.scroll_page_to_textblock(r),e("#comments_sidebar .sidebar_contents_wrapper").scrollTo(i,{duration:cp_scroll_speed,axis:"y",onAfter:function(){CommentPress.setup.comments.highlight(i)}})))})}},CommentPress.settings.DOM.init(),function($){var highlighted_para="";$.highlight_para=function(t){"object"==typeof t&&t.addClass("selected_para")},$.unhighlight_para=function(){var t=$(".textblock");t.removeClass("selected_para")},$.get_highlighted_para=function(){return highlighted_para},$.is_highlighted=function(t){return"object"!=typeof t?!1:t.hasClass("selected_para")?!0:!1},$.in_array=function(t,e,n){var i,s=!1,o=!!n;for(i in e)if(o&&e[i]===t||!o&&e[i]==t){s=!0;break}return s},$.remove_from_array=function(t,e){for(var n=0;n<e.length;n++)if(t===e[n]){e.splice(n,1);break}return e},$.is_object=function(t){return t instanceof Array?!1:null!==t&&"object"==typeof t},$.is_function_defined=function(function_name){return eval("typeof("+function_name+") == typeof(Function)")?!0:!1},$.px_to_num=function(t){return parseInt(t.substring(0,t.length-2))},$.css_to_num=function(t){if(t&&""!=t){var e=parseFloat(t);return"NaN"==e.toString()?0:e}return 0},$.frivolous=function(t){alert(t)},$.get_current_menu_item_id=function(){var t,e,n,i,s=0;if(t=$(".current_page_item"),t.length>0)if(e=t.prop("id"),e.length>0)s=e.split("-")[2];else{i=t.prop("class"),n=i.split(" ");for(var o,a=0;o=n[a++];)if(o.match("page-item-")){s=o.split("-")[2];break}}return s},$.get_text_sig_by_comment_id=function(t){var e,n,i,s;return i="",t.match("#comment-")&&(e=parseInt(t.split("#comment-")[1])),n=$("#comment-"+e).parents("div.paragraph_wrapper").map(function(){return this}),n.length>0&&(s=$(n[0]),i=s.prop("id").split("-")[1]),i},$.on_load_scroll_to_comment=function(){var t,e,n;t=document.location.toString(),t.match("#comment-")&&(e=t.split("#comment-")[1],n=$("#comment-"+e),n.length&&("0"==cp_is_mobile||"1"==cp_is_tablet)&&$.scrollTo(n,{duration:cp_scroll_speed,axis:"y",offset:CommentPress.theme.header.get_offset()}))},$.scroll_comments=function(t,e,n){switch(arguments.length){case 2:n="noflash";break;case 3:break;default:throw new Error("illegal argument count")}("0"==cp_is_mobile||"1"==cp_is_tablet)&&("flash"==n?$("#comments_sidebar .sidebar_contents_wrapper").scrollTo(t,{duration:e,axis:"y",onAfter:function(){CommentPress.setup.comments.highlight(t),$(document).trigger("commentpress-comments-scrolled")}}):$("#comments_sidebar .sidebar_contents_wrapper").scrollTo(t,{duration:e,onAfter:function(){$(document).trigger("commentpress-comments-scrolled")}}))},$.scroll_page=function(t){"undefined"!=typeof t&&("0"==cp_is_mobile||"1"==cp_is_tablet)&&$.scrollTo(t,{duration:1.5*cp_scroll_speed,axis:"y",offset:CommentPress.theme.header.get_offset()})},$.quick_scroll_page=function(t,e){"undefined"!=typeof t&&("0"==cp_is_mobile||"1"==cp_is_tablet)&&$.scrollTo(t,{duration:1.5*e,axis:"y",offset:CommentPress.theme.header.get_offset()})},$.scroll_page_to_textblock=function(t){var e;""!==t?(e=$("#textblock-"+t),$.highlight_para(e),$.scroll_page(e)):(CommentPress.settings.page.toggle_highlight()||CommentPress.theme.viewport.scroll_to_top(0,cp_scroll_speed),CommentPress.settings.page.toggle_highlight())}}(jQuery),jQuery(document).ready(function(t){commentpress_setup_init()});