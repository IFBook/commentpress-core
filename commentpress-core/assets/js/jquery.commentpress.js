var msie_detected=false;if("undefined"!==typeof cp_msie){msie_detected=true}if("undefined"!==typeof CommentpressSettings){var cp_comments_open,cp_special_page,cp_tinymce,cp_tinymce_version,cp_promote_reading,cp_is_mobile,cp_is_touch,cp_is_tablet,cp_cookie_path,cp_multipage_page,cp_template_dir,cp_plugin_dir,cp_toc_chapter_is_page,cp_show_subpages,cp_default_sidebar,cp_is_signup_page,cp_scroll_speed,cp_min_page_width,cp_textblock_meta;cp_comments_open=CommentpressSettings.cp_comments_open;cp_special_page=CommentpressSettings.cp_special_page;cp_tinymce=CommentpressSettings.cp_tinymce;cp_tinymce_version=CommentpressSettings.cp_tinymce_version;cp_promote_reading=CommentpressSettings.cp_promote_reading;cp_is_mobile=CommentpressSettings.cp_is_mobile;cp_is_touch=CommentpressSettings.cp_is_touch;cp_is_tablet=CommentpressSettings.cp_is_tablet;cp_cookie_path=CommentpressSettings.cp_cookie_path;cp_multipage_page=CommentpressSettings.cp_multipage_page;cp_template_dir=CommentpressSettings.cp_template_dir;cp_plugin_dir=CommentpressSettings.cp_plugin_dir;cp_toc_chapter_is_page=CommentpressSettings.cp_toc_chapter_is_page;cp_show_subpages=CommentpressSettings.cp_show_subpages;cp_default_sidebar=CommentpressSettings.cp_default_sidebar;cp_is_signup_page=CommentpressSettings.cp_is_signup_page;cp_scroll_speed=CommentpressSettings.cp_js_scroll_speed;cp_min_page_width=CommentpressSettings.cp_min_page_width;cp_textblock_meta=CommentpressSettings.cp_textblock_meta}var CommentPress=CommentPress||{};CommentPress.settings={};CommentPress.settings.DOM=new function(){var a=this,b=jQuery.noConflict();this.init=function(){a.init_wp_adminbar();a.init_bp_adminbar();a.init_wp_adminbar_height()};this.dom_ready=function(){};this.original_permalink=document.location.toString();this.set_permalink=function(c){this.original_permalink=c};this.get_permalink=function(){return this.original_permalink};this.bp_adminbar="n";this.init_bp_adminbar=function(c){if("undefined"!==typeof CommentpressSettings){this.bp_adminbar=CommentpressSettings.cp_bp_adminbar}};this.set_bp_adminbar=function(c){this.bp_adminbar=c};this.get_bp_adminbar=function(){return this.bp_adminbar};this.wp_adminbar="n";this.init_wp_adminbar=function(c){if("undefined"!==typeof CommentpressSettings){this.wp_adminbar=CommentpressSettings.cp_wp_adminbar}};this.set_wp_adminbar=function(c){this.wp_adminbar=c};this.get_wp_adminbar=function(){return this.wp_adminbar};this.wp_adminbar_height=0;this.init_wp_adminbar_height=function(c){if("undefined"!==typeof CommentpressSettings){this.wp_adminbar_height=parseInt(CommentpressSettings.cp_wp_adminbar_height)}if(a.get_bp_adminbar()=="y"){this.wp_adminbar_height=25;a.set_wp_adminbar("y")}};this.set_wp_adminbar_height=function(c){this.wp_adminbar_height=c};this.get_wp_adminbar_height=function(){return this.wp_adminbar_height};this.wp_adminbar_height=0;this.init_wp_adminbar_expanded=function(c){if("undefined"!==typeof CommentpressSettings){this.wp_adminbar_expanded=parseInt(CommentpressSettings.cp_wp_adminbar_expanded)}};this.set_wp_adminbar_expanded=function(c){this.wp_adminbar_expanded=c};this.get_wp_adminbar_expanded=function(){return this.wp_adminbar_expanded}};CommentPress.settings.page=new function(){var a=this,b=jQuery.noConflict();this.init=function(){};this.dom_ready=function(){};this.highlight=false;this.toggle_highlight=function(){this.highlight=!this.highlight};this.set_highlight=function(c){this.highlight=c};this.get_highlight=function(){return this.highlight}};CommentPress.settings.textblock=new function(){var a=this,b=jQuery.noConflict();this.init=function(){};this.dom_ready=function(){};this.scroll_target="para_heading";this.set_scroll_target=function(c){this.scroll_target=c};this.get_scroll_target=function(){return this.scroll_target}};CommentPress.common={};CommentPress.common.navigation=new function(){var a=this,b=jQuery.noConflict();this.init=function(){};this.dom_ready=function(){a.headings();a.menu()};this.headings=function(){b("h3.activity_heading").css("cursor","pointer");b("#toc_sidebar").on("click","h3.activity_heading",function(d){var c;d.preventDefault();c=b(this).next("div.paragraph_wrapper");c.css("width",b(this).parent().css("width"));c.slideToggle("slow",function(){c.css("width","auto")})})};this.menu=function(){b("#toc_sidebar").on("click","ul#toc_list li a",function(d){if(cp_toc_chapter_is_page=="0"){var c;c=b(this).parent().find("ul");if(c.length>0){if(cp_show_subpages=="0"){b(this).next("ul").slideToggle()}d.preventDefault()}}})}};CommentPress.common.content=new function(){var a=this,b=jQuery.noConflict();this.init=function(){};this.dom_ready=function(){a.title_links();a.textblocks();a.para_markers();a.comment_icons();a.links_in_textblocks();a.footnotes_compatibility()};this.title_links=function(){b("#container").on("click",".post_title a",function(d){d.preventDefault();var c="";CommentPress.settings.textblock.set_scroll_target("para_heading");b(document).trigger("commentpress-post-title-pre-align");CommentPress.theme.viewport.align_content(c,CommentPress.settings.textblock.get_scroll_target());b(document).trigger("commentpress-post-title-clicked")})};this.textblocks=function(){if(cp_is_mobile=="0"){if(cp_textblock_meta=="0"){b("#container").on("mouseover",".textblock",function(c){b(this).addClass("textblock-in")});b("#container").on("mouseout",".textblock",function(c){b(this).removeClass("textblock-in")})}}b("#container").on("click",".textblock",function(d){var c;c=b(this).prop("id");c=c.split("textblock-")[1];CommentPress.settings.textblock.set_scroll_target("para_heading");b(document).trigger("commentpress-post-title-clicked");b(document).trigger("commentpress-textblock-pre-align");CommentPress.theme.viewport.align_content(c,CommentPress.settings.textblock.get_scroll_target());b(document).trigger("commentpress-textblock-clicked")})};this.para_markers=function(){b("#container").on("click","span.para_marker a",function(c){c.preventDefault();b(document).trigger("commentpress-paramarker-clicked")});b("#container").on("mouseenter","span.para_marker a",function(c){var d;d=b(this).parent().next().children(".comment_count");d.addClass("js-hover")});b("#container").on("mouseleave","span.para_marker a",function(c){var d;d=b(this).parent().next().children(".comment_count");d.removeClass("js-hover")})};this.comment_icons=function(){b("#container").on("click",".commenticonbox",function(d){var c;d.preventDefault();d.stopPropagation();c=b(this).children("a.para_permalink").prop("href").split("#")[1];CommentPress.settings.textblock.set_scroll_target("commentform");b(document).trigger("commentpress-commenticonbox-pre-align");CommentPress.theme.viewport.align_content(c,CommentPress.settings.textblock.get_scroll_target());b(document).trigger("commentpress-commenticonbox-clicked")});b("#container").on("click","a.para_permalink",function(c){c.preventDefault()});b("#container").on("mouseenter","a.para_permalink",function(d){var c;c=b(this).prop("href").split("#")[1];b("span.para_marker a#"+c).addClass("js-hover")});b("#container").on("mouseleave","a.para_permalink",function(d){var c;c=b(this).prop("href").split("#")[1];b("span.para_marker a#"+c).removeClass("js-hover")})};this.links_in_textblocks=function(){b("#container").on("click","a.cp_para_link",function(d){var c;d.preventDefault();d.stopPropagation();c=b(this).prop("href").split("#")[1];CommentPress.settings.textblock.set_scroll_target("commentform");b(document).trigger("commentpress-link-in-textblock-pre-align");CommentPress.theme.viewport.align_content(c,CommentPress.settings.textblock.get_scroll_target());b(document).trigger("commentpress-link-in-textblock-clicked")})};this.footnotes_compatibility=function(){b("#container").on("click","span.footnotereverse a, a.footnote-back-link",function(c){var d;c.preventDefault();d=b(this).prop("href").split("#")[1];a.quick_scroll_page("#"+d,100)});b("#container").on("click",".simple-footnotes ol li > a",function(c){var d;d=b(this).prop("href");if(d.match("#return-note-")){c.preventDefault();d=d.split("#")[1];a.quick_scroll_page("#"+d,100)}});b("#container").on("click","a.simple-footnote, sup.footnote a, sup a.footnote-identifier-link, a.zp-ZotpressInText",function(c){var d;c.preventDefault();d=b(this).prop("href").split("#")[1];a.quick_scroll_page("#"+d,100)})};this.scroll_page=function(c){if("undefined"===typeof c){return}if(cp_is_mobile=="0"||cp_is_tablet=="1"){b.scrollTo(c,{duration:(cp_scroll_speed*1.5),axis:"y",offset:CommentPress.theme.header.get_offset()})}};this.quick_scroll_page=function(d,c){if("undefined"===typeof d){return}if(cp_is_mobile=="0"||cp_is_tablet=="1"){b.scrollTo(d,{duration:(c*1.5),axis:"y",offset:CommentPress.theme.header.get_offset()})}};this.scroll_page_to_textblock=function(c){var d;if(c!==""){d=b("#textblock-"+c);b.highlight_para(d);a.scroll_page(d)}else{if(!CommentPress.settings.page.toggle_highlight()){CommentPress.theme.viewport.scroll_to_top(0,cp_scroll_speed)}CommentPress.settings.page.toggle_highlight()}};this.on_load_scroll_to_comment=function(){var c,d,e;c=document.location.toString();if(c.match("#comment-")){d=c.split("#comment-")[1];e=b("#comment-"+d);if(e.length){if(cp_is_mobile=="0"||cp_is_tablet=="1"){b.scrollTo(e,{duration:cp_scroll_speed,axis:"y",offset:CommentPress.theme.header.get_offset()})}}}};this.workflow_tabs=function(d,c){b("#literal .post").css("display","none");b("#original .post").css("display","none");b("#container").on("click","content-tabs li h2 a",function(f){var e;f.preventDefault();e=this.href.split("#")[1];b(".post").css("display","none");b(".workflow-wrapper").css("min-height","0");b(".workflow-wrapper").css("padding-bottom","0");b("#"+e+".workflow-wrapper").css("min-height",d);b("#"+e+".workflow-wrapper").css("padding-bottom",c);b("#"+e+" .post").css("display","block");b("#content-tabs li").removeClass("default-content-tab");b(this).parent().parent().addClass("default-content-tab")})}};CommentPress.common.comments=new function(){var a=this,b=jQuery.noConflict();this.init=function(){};this.dom_ready=function(){a.header();a.minimiser();a.comment_block_permalinks();a.comment_permalinks();a.comment_permalink_copy_links()};this.header=function(){b("#sidebar").on("click","#comments_header h2 a",function(c){c.preventDefault();CommentPress.theme.sidebars.activate_sidebar("comments")})};this.minimiser=function(){b("#sidebar").on("click","#cp_minimise_all_comments",function(c){c.preventDefault();b("#comments_sidebar div.paragraph_wrapper").slideUp();b.unhighlight_para()})};this.comment_block_permalinks=function(){if(cp_special_page=="1"){return}b("a.comment_block_permalink").css("cursor","pointer");b("#comments_sidebar").on("click","a.comment_block_permalink",function(f){var m,k,d,h,i,e,j,c,l,g;f.preventDefault();CommentPress.settings.textblock.set_scroll_target("para_heading");b(document).trigger("commentpress-comment-block-permalink-pre-align");if("none"==CommentPress.settings.textblock.get_scroll_target()){b(document).trigger("commentpress-comment-block-permalink-clicked");return}m=b(this).parent().prop("id").split("para_heading-")[1];k=b(this).parent().next("div.paragraph_wrapper");d=b("#para_wrapper-"+m).find("ol.commentlist");h=false;i=k.css("display");if(i=="none"){h=true}if("undefined"!==typeof m){if(m!==""&&m!="pingbacksandtrackbacks"){e=b("#textblock-"+m);if(h){b.unhighlight_para();b.highlight_para(e);CommentPress.common.content.scroll_page(e)}else{if(cp_promote_reading=="0"){if(b("#para_wrapper-"+m).find("#respond")[0]){b.unhighlight_para()}else{if(!d[0]){b.unhighlight_para();b.highlight_para(e);CommentPress.common.content.scroll_page(e)}}}else{if(b.is_highlighted(e)){b.unhighlight_para()}}}}else{b.unhighlight_para();if(m!="pingbacksandtrackbacks"){CommentPress.theme.viewport.scroll_to_top(0,cp_scroll_speed);CommentPress.settings.page.toggle_highlight()}}}if(cp_promote_reading=="0"&&m!="pingbacksandtrackbacks"){if(cp_comments_open=="y"){j=b("#comment_post_ID").prop("value");c=b("#para_wrapper-"+m+" .reply_to_para").prop("id");l=c.split("-")[1];g=b("#para_wrapper-"+m).find("#respond")[0];if(d.length>0&&d[0]){if(!h&&!g){}else{addComment.moveFormToPara(l,m,j)}}else{if(!g){k.css("display","none");h=true}addComment.moveFormToPara(l,m,j)}}}k.slideToggle("slow",function(){if(h){a.scroll_comments(b("#para_heading-"+m),cp_scroll_speed)}});b(document).trigger("commentpress-comment-block-permalink-clicked")})};this.comment_permalinks=function(){b("#comments_sidebar").on("click",".comment_permalink",function(f){var e,c,d;f.preventDefault();e=this.href.split("#")[1];if(cp_special_page=="1"){c=CommentPress.theme.header.get_offset();b.scrollTo(b("#"+e),{duration:cp_scroll_speed,axis:"y",offset:c})}else{b.unhighlight_para();d=b.get_text_sig_by_comment_id("#"+e);if(d!="pingbacksandtrackbacks"){CommentPress.common.content.scroll_page_to_textblock(d)}a.scroll_comments(b("#"+e),cp_scroll_speed)}})};this.comment_permalink_copy_links=function(){b(".comment_permalink").tooltip({position:{my:"left bottom-20",at:"left top",using:function(c,d){b(this).css(c);b("<div>").addClass("arrow").addClass(d.vertical).addClass(d.horizontal).appendTo(this)}}});b("#comments_sidebar").on("click",".comment_permalink",function(d){var c;c=b(this).attr("href");if(c){if(window.history){window.history.replaceState({},"",c);b(document).bind("click",a.comment_permalink_handler)}}})};this.comment_permalink_handler=function(c){if(!b(c.target).closest(".comment_permalink").length){b(document).unbind("click",a.comment_permalink_handler);window.history.replaceState({},"",CommentPress.settings.DOM.get_permalink())}};this.comment_rollovers=function(){b("#comments_sidebar").on("mouseenter",".comment-wrapper",function(c){b(this).addClass("background-highlight")});b("#comments_sidebar").on("mouseleave",".comment-wrapper",function(c){b(this).removeClass("background-highlight")})};this.highlight=function(c){c.addClass("notransition");if(c.hasClass("comment-fade")){c.removeClass("comment-fade")}if(c.hasClass("comment-highlighted")){c.removeClass("comment-highlighted")}c.addClass("comment-highlighted");c.removeClass("notransition");c.height();c.addClass("comment-fade")};this.scroll_comments=function(e,d,c){switch(arguments.length){case 2:c="noflash";break;case 3:break;default:throw new Error("illegal argument count")}if(cp_is_mobile=="0"||cp_is_tablet=="1"){if(c=="flash"){b("#comments_sidebar .sidebar_contents_wrapper").scrollTo(e,{duration:d,axis:"y",onAfter:function(){CommentPress.common.comments.highlight(e);b(document).trigger("commentpress-comments-scrolled")}})}else{b("#comments_sidebar .sidebar_contents_wrapper").scrollTo(e,{duration:d,onAfter:function(){b(document).trigger("commentpress-comments-scrolled")}})}}}};CommentPress.common.activity=new function(){var a=this,b=jQuery.noConflict();this.init=function(){};this.dom_ready=function(){a.header();a.minimiser();a.headings();a.see_in_context_links()};this.header=function(){b("#sidebar").on("click","#activity_header h2 a",function(c){c.preventDefault();CommentPress.theme.sidebars.activate_sidebar("activity")})};this.minimiser=function(){b("#sidebar").on("click","#cp_minimise_all_activity",function(c){c.preventDefault();b("#activity_sidebar div.paragraph_wrapper").slideUp()})};this.headings=function(){b("h3.activity_heading").css("cursor","pointer");b("#activity_sidebar").on("click","h3.activity_heading",function(d){var c;d.preventDefault();c=b(this).next("div.paragraph_wrapper");c.css("width",b(this).parent().css("width"));c.slideToggle("slow",function(){c.css("width","auto")})})};this.see_in_context_links=function(){if(cp_special_page=="1"){return}b("#activity_sidebar").on("click","a.comment_on_post",function(h){var f,i,c,g,d,e;h.preventDefault();CommentPress.theme.sidebars.activate_sidebar("comments");f=this.href.split("#")[1];i=b("#"+f);c=i.parents("div.paragraph_wrapper").map(function(){return this});if(c.length>0){g=b(c[0]);g.show();if(cp_special_page=="1"){d=CommentPress.theme.header.get_offset();b.scrollTo(i,{duration:cp_scroll_speed,axis:"y",offset:d})}else{b.unhighlight_para();e=g.prop("id").split("-")[1];CommentPress.common.content.scroll_page_to_textblock(e);b("#comments_sidebar .sidebar_contents_wrapper").scrollTo(i,{duration:cp_scroll_speed,axis:"y",onAfter:function(){CommentPress.common.comments.highlight(i)}})}}})}};CommentPress.common.viewport=new function(){var a=this,b=jQuery.noConflict();this.init=function(){};this.dom_ready=function(){}};(function($){var highlighted_para="";$.highlight_para=function(element){if(typeof(element)!="object"){return}element.addClass("selected_para")};$.unhighlight_para=function(){var highlighted_paras=$(".textblock");highlighted_paras.removeClass("selected_para")};$.get_highlighted_para=function(){return highlighted_para};$.is_highlighted=function(element){if(typeof(element)!="object"){return false}if(element.hasClass("selected_para")){return true}else{return false}};$.in_array=function(needle,haystack,argStrict){var found=false,key,strict=!!argStrict;for(key in haystack){if((strict&&haystack[key]===needle)||(!strict&&haystack[key]==needle)){found=true;break}}return found};$.remove_from_array=function(item,sourceArray){for(var i=0;i<sourceArray.length;i++){if(item===sourceArray[i]){sourceArray.splice(i,1);break}}return sourceArray};$.is_object=function(mixed_var){if(mixed_var instanceof Array){return false}else{return(mixed_var!==null)&&(typeof(mixed_var)=="object")}};$.is_function_defined=function(function_name){if(eval("typeof("+function_name+") == typeof(Function)")){return true}return false};$.px_to_num=function(pix){return parseInt(pix.substring(0,(pix.length-2)))};$.css_to_num=function(strNum){if(strNum&&strNum!=""){var i=parseFloat(strNum);if(i.toString()=="NaN"){return 0}else{return i}}return 0};$.frivolous=function(message){alert(message)};$.get_current_menu_item_id=function(){var current_menu_item=0,current_menu_obj,current_item_id,current_item_classes,current_item_class;current_menu_obj=$(".current_page_item");if(current_menu_obj.length>0){current_item_id=current_menu_obj.prop("id");if(current_item_id.length>0){current_menu_item=current_item_id.split("-")[2]}else{current_item_class=current_menu_obj.prop("class");current_item_classes=current_item_class.split(" ");for(var i=0,item;item=current_item_classes[i++];){if(item.match("page-item-")){current_menu_item=item.split("-")[2];break}}}}return current_menu_item};$.get_text_sig_by_comment_id=function(cid){var comment_id,para_wrapper_array,text_sig,item;text_sig="";if(cid.match("#comment-")){comment_id=parseInt(cid.split("#comment-")[1])}para_wrapper_array=$("#comment-"+comment_id).parents("div.paragraph_wrapper").map(function(){return this});if(para_wrapper_array.length>0){item=$(para_wrapper_array[0]);text_sig=item.prop("id").split("-")[1]}return text_sig}})(jQuery);CommentPress.settings.DOM.init();CommentPress.settings.page.init();CommentPress.settings.textblock.init();CommentPress.common.navigation.init();CommentPress.common.content.init();CommentPress.common.comments.init();CommentPress.common.activity.init();jQuery(document).ready(function(a){CommentPress.settings.DOM.dom_ready();CommentPress.settings.page.dom_ready();CommentPress.settings.textblock.dom_ready();CommentPress.common.navigation.dom_ready();CommentPress.common.content.dom_ready();CommentPress.common.comments.dom_ready();CommentPress.common.activity.dom_ready();jQuery(document).trigger("commentpress-initialised")});