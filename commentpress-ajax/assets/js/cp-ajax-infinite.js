var cpajax_nonce,cpajax_post_url,cpajax_post_title,cpajax_infinite_posts,cpajax_infinite_comments,cpajax_comment_form,cpajax_comments_open,cpajax_history_supported;if("undefined"!==typeof CommentpressAjaxInfiniteSettings){cpajax_nonce=CommentpressAjaxInfiniteSettings.nonce}cpajax_infinite_posts=new Array;cpajax_infinite_comments="";cpajax_comment_form=0;cpajax_post_url=document.location.href;cpajax_post_title=document.title;cpajax_history_supported=false;(function(f){f(document).ready(function(m){c();j();g()});function g(){jQuery(".previous_page, .next_page").unbind("click");if(window.history.length>0){f(".previous_page").click(function(m){alert("back");if(event.preventDefault){event.preventDefault()}window.history.back();return false})}f(".next_page").click(function(m){alert("forward");if(event.preventDefault){event.preventDefault()}a("link");return false})}function c(){addComment.disableForm();cpajax_comment_form=f("#respond_wrapper").clone();f("form",cpajax_comment_form).attr("id","commentform-disabled");if(f("#respond_wrapper",cpajax_comment_form).hasClass("cp_force_displayed")){f("#respond_wrapper",cpajax_comment_form).removeClass("cp_force_displayed")}if(f("#respond_wrapper",cpajax_comment_form).hasClass("cp_force_closed")){f("#respond_wrapper",cpajax_comment_form).removeClass("cp_force_closed")}if(f("#respond_wrapper").hasClass("cp_force_closed")){f("#respond_wrapper").remove()}}function k(){var m;m=f("#wrapper .post").prop("id").split("-")[1];cpajax_infinite_comments[m]=f("#comments_sidebar .comments_container")}function e(m){f("#toc_list .menu-item").removeClass("current_page_item");f("#menu-item-"+m).addClass("current_page_item");f("#toc_list .menu-item").removeClass("current_page_ancestor");f("#menu-item-"+m).parents("li").addClass("current_page_ancestor")}function l(m){f("#toc_list .page_item").removeClass("current_page_item");f(".page-item-"+m).addClass("current_page_item");f("#toc_list .page_item").removeClass("current_page_ancestor");f(".page-item-"+m).parents("li").addClass("current_page_ancestor")}function b(){commentpress_setup_comment_headers();commentpress_setup_comment_headers();commentpress_enable_comment_permalink_clicks();commentpress_setup_para_permalink_icons();commentpress_setup_page_click_actions();commentpress_setup_para_links();cp_enable_context_clicks();commentpress_setup_context_headers();commentpress_setup_footnotes_compatibility();cpajax_reassign_comments();cpajax_initialise();cpajax_initialise_form();g();if(f.is_function_defined("bpgsites_init_elements")){bpgsites_init_elements()}}function j(){f("#wrapper").waypoint(function(m){if(m==="down"){a("waypoint")}else{}},{offset:"bottom-in-view"})}function a(n){var m;m=f("#main_wrapper .post:last-child").prop("id").split("-")[1];if(f.in_array(m,cpajax_infinite_posts)){return}f("#main_wrapper").after('<div class="cp_next_page_loading_wrapper" style="text-align: center"><img src="'+cpajax_spinner_url+'" id="cp_next_page_loading" alt="'+cpajax_lang[0]+'" /></div>');f.ajax({url:cpajax_ajax_url,type:"POST",dataType:"json",data:{action:"cpajax_load_next_page",current_post_id:m,nonce:cpajax_nonce},success:function(o){d(o,n);f(".cp_next_page_loading_wrapper").remove()}})}function d(q,s){var v,p,r,n,m,u,t,o;o=f("#main_wrapper .post:last-child").prop("id").split("-")[1];cpajax_post_url=q.url;cpajax_post_title=q.title;n=f("#main_wrapper .post:last-child").prop("class");v=f(".post",f(q.content));f("#main_wrapper").append(v.parents(".page_wrapper"));p=v.prop("id");if(typeof p!=="undefined"){cpajax_infinite_posts.push(o);r=p.split("-")[1];u=f(".comments_container",f(q.comments));if(cpajax_comment_form!==0){t=cpajax_comment_form.clone();f("form",t).attr("id","commentform");f("#comment_post_ID",t).val(r);cpajax_infinite_comments=u.append(t);cpajax_comments_open="n";if(q.comment_status=="open"){cpajax_comments_open="y"}}if(n!="post"){m=n.split("-")[1];if(n.match("wpcustom_menuid-")){e(m)}else{l(m)}}i(r);f(document).trigger("commentpress-new-post-loaded");b()}f.waypoints("refresh");if(s=="link"){commentpress_scroll_page(v)}}function i(m){f("#post-"+m+".post").parent().parent().waypoint(function(n){if(n==="down"){h(f(this))}},{triggerOnce:true,offset:function(){var n;n=f("#header").height();if(cp_wp_adminbar=="y"){n+=cp_wp_adminbar_height}return n}})}function h(n){var u,p,q,r,m,o,s,t;u=f(".post",n);p=u.prop("id").split("-")[1];q=u.prop("class");if(q!="post"){menu_item_id=q.split("-")[1];if(q.match("wpcustom_menuid-")){e(menu_item_id)}else{l(menu_item_id)}f("#wrapper").waypoint("disable");m=f("#main_wrapper");o=n.prev();o.waypoint("destroy");n.waypoint("destroy");m.css("position","fixed");o.remove();document.title=cpajax_post_title;if(window.history){s=f.trim(n.html());window.history.pushState({post_id:p,post_permalink:cpajax_post_url,page_title:cpajax_post_title,html:s,comment_status:cp_comments_open},"",cpajax_post_url)}f(document).scrollTop(0);m.css("position","relative");f("#wrapper").waypoint("enable");t=cpajax_infinite_comments;if(cpajax_comment_form!==0){addComment.disableForm()}f("#comments_sidebar .comments_container").replaceWith(t);cp_comments_open=cpajax_comments_open;if(cpajax_comment_form!==0){addComment.enableForm()}b();f.waypoints("refresh");f(document).trigger("commentpress-post-changed")}}window.onpopstate=function(m){if(m.state){document.title=m.state.page_title;f("#main_wrapper").prepend('<div class="page_wrapper cp_page_wrapper">'+m.state.html+"</div>")}}})(jQuery);