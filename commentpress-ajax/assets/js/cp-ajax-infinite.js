var cpajax_nonce,cpajax_post_url,cpajax_post_title,cpajax_infinite_posts,cpajax_infinite_comments,cpajax_comment_form,cpajax_comments_open,cpajax_history_supported;"undefined"!=typeof CommentpressAjaxInfiniteSettings&&(cpajax_nonce=CommentpressAjaxInfiniteSettings.nonce),cpajax_infinite_posts=new Array,cpajax_infinite_comments="",cpajax_comment_form=0,cpajax_post_url=document.location.href,cpajax_post_title=document.title,cpajax_history_supported=!1,function(e){function t(){jQuery(".previous_page, .next_page").unbind("click"),window.history.length>0&&e(".previous_page").click(function(e){alert("back"),event.preventDefault&&event.preventDefault(),window.history.back()}),e(".next_page").click(function(e){alert("forward"),event.preventDefault&&event.preventDefault(),r("link")})}function a(){addComment.disableForm(),cpajax_comment_form=e("#respond_wrapper").clone(),e("form",cpajax_comment_form).attr("id","commentform-disabled"),e("#respond_wrapper",cpajax_comment_form).hasClass("cp_force_displayed")&&e("#respond_wrapper",cpajax_comment_form).removeClass("cp_force_displayed"),e("#respond_wrapper",cpajax_comment_form).hasClass("cp_force_closed")&&e("#respond_wrapper",cpajax_comment_form).removeClass("cp_force_closed"),e("#respond_wrapper").hasClass("cp_force_closed")&&e("#respond_wrapper").remove()}function n(t){e("#toc_list .menu-item").removeClass("current_page_item"),e("#menu-item-"+t).addClass("current_page_item"),e("#toc_list .menu-item").removeClass("current_page_ancestor"),e("#menu-item-"+t).parents("li").addClass("current_page_ancestor")}function p(t){e("#toc_list .page_item").removeClass("current_page_item"),e(".page-item-"+t).addClass("current_page_item"),e("#toc_list .page_item").removeClass("current_page_ancestor"),e(".page-item-"+t).parents("li").addClass("current_page_ancestor")}function o(){CommentPress.ajax.comments.reassign_comments(),CommentPress.ajax.comments.initialise(),CommentPress.ajax.comments.initialise_form(),t(),e.is_function_defined("bpgsites_init_elements")&&bpgsites_init_elements()}function s(){e("#wrapper").waypoint(function(e){"down"===e&&r("waypoint")},{offset:"bottom-in-view"})}function r(t){var a;a=e("#main_wrapper .post:last-child").prop("id").split("-")[1],e.in_array(a,cpajax_infinite_posts)||(e("#main_wrapper").after('<div class="cp_next_page_loading_wrapper" style="text-align: center"><img src="'+cpajax_spinner_url+'" id="cp_next_page_loading" alt="'+cpajax_lang[0]+'" /></div>'),e.ajax({url:cpajax_ajax_url,type:"POST",dataType:"json",data:{action:"cpajax_load_next_page",current_post_id:a,nonce:cpajax_nonce},success:function(a){i(a,t),e(".cp_next_page_loading_wrapper").remove()}}))}function i(t,a){var s,r,i,c,m,l,d,u;u=e("#main_wrapper .post:last-child").prop("id").split("-")[1],cpajax_post_url=t.url,cpajax_post_title=t.title,c=e("#main_wrapper .post:last-child").prop("class"),s=e(".post",e(t.content)),e("#main_wrapper").append(s.parents(".page_wrapper")),r=s.prop("id"),"undefined"!=typeof r&&(cpajax_infinite_posts.push(u),i=r.split("-")[1],l=e(".comments_container",e(t.comments)),0!==cpajax_comment_form&&(d=cpajax_comment_form.clone(),e("form",d).attr("id","commentform"),e("#comment_post_ID",d).val(i),cpajax_infinite_comments=l.append(d),cpajax_comments_open="n","open"==t.comment_status&&(cpajax_comments_open="y")),"post"!=c&&(m=c.split("-")[1],c.match("wpcustom_menuid-")?n(m):p(m)),_(i),e(document).trigger("commentpress-new-post-loaded"),o()),e.waypoints("refresh"),"link"==a&&jQuery.scroll_page(s)}function _(t){e("#post-"+t+".post").parent().parent().waypoint(function(t){"down"===t&&c(e(this))},{triggerOnce:!0,offset:function(){var t;return t=e("#header").height(),"y"==CommentPress.settings.DOM.get_wp_adminbar()&&(t+=CommentPress.settings.DOM.get_wp_adminbar_height()),t}})}function c(t){var a,s,r,i,_,c,m;a=e(".post",t),s=a.prop("id").split("-")[1],r=a.prop("class"),"post"!=r&&(menu_item_id=r.split("-")[1],r.match("wpcustom_menuid-")?n(menu_item_id):p(menu_item_id),e("#wrapper").waypoint("disable"),i=e("#main_wrapper"),_=t.prev(),_.waypoint("destroy"),t.waypoint("destroy"),i.css("position","fixed"),_.remove(),document.title=cpajax_post_title,window.history&&(c=e.trim(t.html()),window.history.pushState({post_id:s,post_permalink:cpajax_post_url,page_title:cpajax_post_title,html:c,comment_status:cp_comments_open},"",cpajax_post_url)),e(document).scrollTop(0),i.css("position","relative"),e("#wrapper").waypoint("enable"),m=cpajax_infinite_comments,0!==cpajax_comment_form&&addComment.disableForm(),e("#comments_sidebar .comments_container").replaceWith(m),cp_comments_open=cpajax_comments_open,0!==cpajax_comment_form&&addComment.enableForm(),o(),e.waypoints("refresh"),e(document).trigger("commentpress-post-changed"))}e(document).ready(function(e){a(),s(),t()}),window.onpopstate=function(t){t.state&&(document.title=t.state.page_title,e("#main_wrapper").prepend('<div class="page_wrapper cp_page_wrapper">'+t.state.html+"</div>"))}}(jQuery);