var cpajax_live,cpajax_ajax_url,cpajax_spinner_url,cpajax_post_id,cpajax_submitting,cpajax_lang;if("undefined"!==typeof CommentpressAjaxSettings){cpajax_live=CommentpressAjaxSettings.cpajax_live;cpajax_ajax_url=CommentpressAjaxSettings.cpajax_ajax_url;cpajax_spinner_url=CommentpressAjaxSettings.cpajax_spinner_url;cpajax_post_id=CommentpressAjaxSettings.cpajax_post_id;cpajax_lang=CommentpressAjaxSettings.cpajax_lang}cpajax_submitting=false;function cpajax_reenable_featured_comments(){if("undefined"!==typeof featured_comments){if(jQuery.is_function_defined("featured_comments_click")){featured_comments_click()}}}function cpajax_reenable_comment_upvoter(){if("undefined"!==typeof comment_upvoter){if(jQuery.is_function_defined("comment_upvoter_click")){comment_upvoter_click()}}}jQuery(document).ready(function(f){var a,d;function h(){jQuery("#respond_title").after('<div id="cpajax_error_msg"></div>');jQuery("#submit").after('<img src="'+cpajax_spinner_url+'" id="loading" alt="'+cpajax_lang[0]+'" />');jQuery("#loading").hide();a=jQuery("#commentform");d=jQuery("#cpajax_error_msg");d.hide()}h();function e(){jQuery("#loading").hide();jQuery("#submit").removeAttr("disabled");jQuery("#submit").show();addComment.enableForm();cpajax_submitting=false}function g(j){var l,n,m,k;l=a.find("#comment_parent").val();n=jQuery("ol.commentlist:first");if(l!="0"){m="#li-comment-"+l;child_list=jQuery(m+" > ol.children:first");if(child_list[0]){b(j,m+" > ol.children:first > li:last",child_list,m+" > ol.children:first > li:last")}else{b(j,m+" > ol.children:first",m,m+" > ol.children:first > li:last")}}else{if(n[0]){b(j,"ol.commentlist:first > li:last",n,"ol.commentlist:first > li:last")}else{b(j,"ol.commentlist:first","div.comments_container","ol.commentlist:first > li:last")}}commentpress_enable_comment_permalink_clicks();k=j.find("#comments_in_page_wrapper div.comments_container > h3");jQuery("#comments_in_page_wrapper div.comments_container > h3").replaceWith(k);a.find("#comment").val("");cpajax_reenable_featured_comments();cpajax_reenable_comment_upvoter()}function b(j,l,m,k){if(j===undefined||j===null){return}j.find(l).hide().appendTo(m);i(l,k)}function c(j,l,m,k){if(j===undefined||j===null){return}j.find(l).hide().prependTo(m);i(l,k)}function i(l,k){var j,m,n;j=jQuery(k).prop("id");m="#comment-"+j.split("-")[2];n=jQuery(m);addComment.cancelForm();n.addClass("comment-highlighted");jQuery(l).slideDown("slow",function(){jQuery.scrollTo(n,{duration:cp_scroll_speed,axis:"y",offset:commentpress_get_header_offset(),onAfter:function(){n.addClass("comment-fade")}})})}jQuery("#commentform").on("submit",function(k){var j;cpajax_submitting=true;d.hide();if(a.find("#author")[0]){if(a.find("#author").val()==""){d.html('<span class="error">'+cpajax_lang[1]+"</span>");d.show();cpajax_submitting=false;return false}if(a.find("#email").val()==""){d.html('<span class="error">'+cpajax_lang[2]+"</span>");d.show();cpajax_submitting=false;return false}j=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!j.test(a.find("#email").val())){d.html('<span class="error">'+cpajax_lang[3]+"</span>");d.show();if(k.preventDefault){k.preventDefault()}cpajax_submitting=false;return false}}if(cp_tinymce=="1"){tinyMCE.triggerSave();addComment.disableForm()}if(a.find("#comment").val()==""){d.html('<span class="error">'+cpajax_lang[4]+"</span>");d.show();addComment.enableForm();cpajax_submitting=false;return false}jQuery(this).ajaxSubmit({beforeSubmit:function(){jQuery("#loading").show();jQuery("#submit").prop("disabled","disabled");jQuery("#submit").hide()},error:function(l){var m;d.empty();m=l.responseText.match(/<p>(.*)<\/p>/);d.html('<span class="error">'+m[1]+"</span>");d.show();e();return false},success:function(m){var l;try{if(jQuery.parseHTML){l=jQuery(jQuery.parseHTML(m))}else{l=jQuery(m)}g(l);e()}catch(n){e();alert(cpajax_lang[6]+"\n\n"+n)}}});return false})});